"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@ai-sdk+google@1.2.22_zod@3.24.2";
exports.ids = ["vendor-chunks/@ai-sdk+google@1.2.22_zod@3.24.2"];
exports.modules = {

/***/ "(rsc)/./node_modules/.pnpm/@ai-sdk+google@1.2.22_zod@3.24.2/node_modules/@ai-sdk/google/dist/index.mjs":
/*!********************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@ai-sdk+google@1.2.22_zod@3.24.2/node_modules/@ai-sdk/google/dist/index.mjs ***!
  \********************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createGoogleGenerativeAI: () => (/* binding */ createGoogleGenerativeAI),\n/* harmony export */   google: () => (/* binding */ google)\n/* harmony export */ });\n/* harmony import */ var _ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @ai-sdk/provider-utils */ \"(rsc)/./node_modules/.pnpm/@ai-sdk+provider-utils@2.2.8_zod@3.24.2/node_modules/@ai-sdk/provider-utils/dist/index.mjs\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.24.2/node_modules/zod/lib/index.mjs\");\n/* harmony import */ var _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @ai-sdk/provider */ \"(rsc)/./node_modules/.pnpm/@ai-sdk+provider@1.1.3/node_modules/@ai-sdk/provider/dist/index.mjs\");\n// src/google-provider.ts\n\n\n// src/google-generative-ai-language-model.ts\n\n\n\n// src/convert-json-schema-to-openapi-schema.ts\nfunction convertJSONSchemaToOpenAPISchema(jsonSchema) {\n  if (isEmptyObjectSchema(jsonSchema)) {\n    return void 0;\n  }\n  if (typeof jsonSchema === \"boolean\") {\n    return { type: \"boolean\", properties: {} };\n  }\n  const {\n    type,\n    description,\n    required,\n    properties,\n    items,\n    allOf,\n    anyOf,\n    oneOf,\n    format,\n    const: constValue,\n    minLength,\n    enum: enumValues\n  } = jsonSchema;\n  const result = {};\n  if (description)\n    result.description = description;\n  if (required)\n    result.required = required;\n  if (format)\n    result.format = format;\n  if (constValue !== void 0) {\n    result.enum = [constValue];\n  }\n  if (type) {\n    if (Array.isArray(type)) {\n      if (type.includes(\"null\")) {\n        result.type = type.filter((t) => t !== \"null\")[0];\n        result.nullable = true;\n      } else {\n        result.type = type;\n      }\n    } else if (type === \"null\") {\n      result.type = \"null\";\n    } else {\n      result.type = type;\n    }\n  }\n  if (enumValues !== void 0) {\n    result.enum = enumValues;\n  }\n  if (properties != null) {\n    result.properties = Object.entries(properties).reduce(\n      (acc, [key, value]) => {\n        acc[key] = convertJSONSchemaToOpenAPISchema(value);\n        return acc;\n      },\n      {}\n    );\n  }\n  if (items) {\n    result.items = Array.isArray(items) ? items.map(convertJSONSchemaToOpenAPISchema) : convertJSONSchemaToOpenAPISchema(items);\n  }\n  if (allOf) {\n    result.allOf = allOf.map(convertJSONSchemaToOpenAPISchema);\n  }\n  if (anyOf) {\n    if (anyOf.some(\n      (schema) => typeof schema === \"object\" && (schema == null ? void 0 : schema.type) === \"null\"\n    )) {\n      const nonNullSchemas = anyOf.filter(\n        (schema) => !(typeof schema === \"object\" && (schema == null ? void 0 : schema.type) === \"null\")\n      );\n      if (nonNullSchemas.length === 1) {\n        const converted = convertJSONSchemaToOpenAPISchema(nonNullSchemas[0]);\n        if (typeof converted === \"object\") {\n          result.nullable = true;\n          Object.assign(result, converted);\n        }\n      } else {\n        result.anyOf = nonNullSchemas.map(convertJSONSchemaToOpenAPISchema);\n        result.nullable = true;\n      }\n    } else {\n      result.anyOf = anyOf.map(convertJSONSchemaToOpenAPISchema);\n    }\n  }\n  if (oneOf) {\n    result.oneOf = oneOf.map(convertJSONSchemaToOpenAPISchema);\n  }\n  if (minLength !== void 0) {\n    result.minLength = minLength;\n  }\n  return result;\n}\nfunction isEmptyObjectSchema(jsonSchema) {\n  return jsonSchema != null && typeof jsonSchema === \"object\" && jsonSchema.type === \"object\" && (jsonSchema.properties == null || Object.keys(jsonSchema.properties).length === 0) && !jsonSchema.additionalProperties;\n}\n\n// src/convert-to-google-generative-ai-messages.ts\n\n\nfunction convertToGoogleGenerativeAIMessages(prompt) {\n  var _a, _b;\n  const systemInstructionParts = [];\n  const contents = [];\n  let systemMessagesAllowed = true;\n  for (const { role, content } of prompt) {\n    switch (role) {\n      case \"system\": {\n        if (!systemMessagesAllowed) {\n          throw new _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_0__.UnsupportedFunctionalityError({\n            functionality: \"system messages are only supported at the beginning of the conversation\"\n          });\n        }\n        systemInstructionParts.push({ text: content });\n        break;\n      }\n      case \"user\": {\n        systemMessagesAllowed = false;\n        const parts = [];\n        for (const part of content) {\n          switch (part.type) {\n            case \"text\": {\n              parts.push({ text: part.text });\n              break;\n            }\n            case \"image\": {\n              parts.push(\n                part.image instanceof URL ? {\n                  fileData: {\n                    mimeType: (_a = part.mimeType) != null ? _a : \"image/jpeg\",\n                    fileUri: part.image.toString()\n                  }\n                } : {\n                  inlineData: {\n                    mimeType: (_b = part.mimeType) != null ? _b : \"image/jpeg\",\n                    data: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.convertUint8ArrayToBase64)(part.image)\n                  }\n                }\n              );\n              break;\n            }\n            case \"file\": {\n              parts.push(\n                part.data instanceof URL ? {\n                  fileData: {\n                    mimeType: part.mimeType,\n                    fileUri: part.data.toString()\n                  }\n                } : {\n                  inlineData: {\n                    mimeType: part.mimeType,\n                    data: part.data\n                  }\n                }\n              );\n              break;\n            }\n          }\n        }\n        contents.push({ role: \"user\", parts });\n        break;\n      }\n      case \"assistant\": {\n        systemMessagesAllowed = false;\n        contents.push({\n          role: \"model\",\n          parts: content.map((part) => {\n            switch (part.type) {\n              case \"text\": {\n                return part.text.length === 0 ? void 0 : { text: part.text };\n              }\n              case \"file\": {\n                if (part.mimeType !== \"image/png\") {\n                  throw new _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_0__.UnsupportedFunctionalityError({\n                    functionality: \"Only PNG images are supported in assistant messages\"\n                  });\n                }\n                if (part.data instanceof URL) {\n                  throw new _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_0__.UnsupportedFunctionalityError({\n                    functionality: \"File data URLs in assistant messages are not supported\"\n                  });\n                }\n                return {\n                  inlineData: {\n                    mimeType: part.mimeType,\n                    data: part.data\n                  }\n                };\n              }\n              case \"tool-call\": {\n                return {\n                  functionCall: {\n                    name: part.toolName,\n                    args: part.args\n                  }\n                };\n              }\n            }\n          }).filter((part) => part !== void 0)\n        });\n        break;\n      }\n      case \"tool\": {\n        systemMessagesAllowed = false;\n        contents.push({\n          role: \"user\",\n          parts: content.map((part) => ({\n            functionResponse: {\n              name: part.toolName,\n              response: {\n                name: part.toolName,\n                content: part.result\n              }\n            }\n          }))\n        });\n        break;\n      }\n    }\n  }\n  return {\n    systemInstruction: systemInstructionParts.length > 0 ? { parts: systemInstructionParts } : void 0,\n    contents\n  };\n}\n\n// src/get-model-path.ts\nfunction getModelPath(modelId) {\n  return modelId.includes(\"/\") ? modelId : `models/${modelId}`;\n}\n\n// src/google-error.ts\n\n\nvar googleErrorDataSchema = zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n  error: zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n    code: zod__WEBPACK_IMPORTED_MODULE_2__.z.number().nullable(),\n    message: zod__WEBPACK_IMPORTED_MODULE_2__.z.string(),\n    status: zod__WEBPACK_IMPORTED_MODULE_2__.z.string()\n  })\n});\nvar googleFailedResponseHandler = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.createJsonErrorResponseHandler)({\n  errorSchema: googleErrorDataSchema,\n  errorToMessage: (data) => data.error.message\n});\n\n// src/google-prepare-tools.ts\n\nfunction prepareTools(mode, useSearchGrounding, dynamicRetrievalConfig, modelId) {\n  var _a, _b;\n  const tools = ((_a = mode.tools) == null ? void 0 : _a.length) ? mode.tools : void 0;\n  const toolWarnings = [];\n  const isGemini2 = modelId.includes(\"gemini-2\");\n  const supportsDynamicRetrieval = modelId.includes(\"gemini-1.5-flash\") && !modelId.includes(\"-8b\");\n  if (useSearchGrounding) {\n    return {\n      tools: isGemini2 ? { googleSearch: {} } : {\n        googleSearchRetrieval: !supportsDynamicRetrieval || !dynamicRetrievalConfig ? {} : { dynamicRetrievalConfig }\n      },\n      toolConfig: void 0,\n      toolWarnings\n    };\n  }\n  if (tools == null) {\n    return { tools: void 0, toolConfig: void 0, toolWarnings };\n  }\n  const functionDeclarations = [];\n  for (const tool of tools) {\n    if (tool.type === \"provider-defined\") {\n      toolWarnings.push({ type: \"unsupported-tool\", tool });\n    } else {\n      functionDeclarations.push({\n        name: tool.name,\n        description: (_b = tool.description) != null ? _b : \"\",\n        parameters: convertJSONSchemaToOpenAPISchema(tool.parameters)\n      });\n    }\n  }\n  const toolChoice = mode.toolChoice;\n  if (toolChoice == null) {\n    return {\n      tools: { functionDeclarations },\n      toolConfig: void 0,\n      toolWarnings\n    };\n  }\n  const type = toolChoice.type;\n  switch (type) {\n    case \"auto\":\n      return {\n        tools: { functionDeclarations },\n        toolConfig: { functionCallingConfig: { mode: \"AUTO\" } },\n        toolWarnings\n      };\n    case \"none\":\n      return {\n        tools: { functionDeclarations },\n        toolConfig: { functionCallingConfig: { mode: \"NONE\" } },\n        toolWarnings\n      };\n    case \"required\":\n      return {\n        tools: { functionDeclarations },\n        toolConfig: { functionCallingConfig: { mode: \"ANY\" } },\n        toolWarnings\n      };\n    case \"tool\":\n      return {\n        tools: { functionDeclarations },\n        toolConfig: {\n          functionCallingConfig: {\n            mode: \"ANY\",\n            allowedFunctionNames: [toolChoice.toolName]\n          }\n        },\n        toolWarnings\n      };\n    default: {\n      const _exhaustiveCheck = type;\n      throw new _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_0__.UnsupportedFunctionalityError({\n        functionality: `Unsupported tool choice type: ${_exhaustiveCheck}`\n      });\n    }\n  }\n}\n\n// src/map-google-generative-ai-finish-reason.ts\nfunction mapGoogleGenerativeAIFinishReason({\n  finishReason,\n  hasToolCalls\n}) {\n  switch (finishReason) {\n    case \"STOP\":\n      return hasToolCalls ? \"tool-calls\" : \"stop\";\n    case \"MAX_TOKENS\":\n      return \"length\";\n    case \"IMAGE_SAFETY\":\n    case \"RECITATION\":\n    case \"SAFETY\":\n    case \"BLOCKLIST\":\n    case \"PROHIBITED_CONTENT\":\n    case \"SPII\":\n      return \"content-filter\";\n    case \"FINISH_REASON_UNSPECIFIED\":\n    case \"OTHER\":\n      return \"other\";\n    case \"MALFORMED_FUNCTION_CALL\":\n      return \"error\";\n    default:\n      return \"unknown\";\n  }\n}\n\n// src/google-generative-ai-language-model.ts\nvar GoogleGenerativeAILanguageModel = class {\n  constructor(modelId, settings, config) {\n    this.specificationVersion = \"v1\";\n    this.defaultObjectGenerationMode = \"json\";\n    this.supportsImageUrls = false;\n    this.modelId = modelId;\n    this.settings = settings;\n    this.config = config;\n  }\n  get supportsStructuredOutputs() {\n    var _a;\n    return (_a = this.settings.structuredOutputs) != null ? _a : true;\n  }\n  get provider() {\n    return this.config.provider;\n  }\n  async getArgs({\n    mode,\n    prompt,\n    maxTokens,\n    temperature,\n    topP,\n    topK,\n    frequencyPenalty,\n    presencePenalty,\n    stopSequences,\n    responseFormat,\n    seed,\n    providerMetadata\n  }) {\n    var _a, _b, _c;\n    const type = mode.type;\n    const warnings = [];\n    const googleOptions = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.parseProviderOptions)({\n      provider: \"google\",\n      providerOptions: providerMetadata,\n      schema: googleGenerativeAIProviderOptionsSchema\n    });\n    if (((_a = googleOptions == null ? void 0 : googleOptions.thinkingConfig) == null ? void 0 : _a.includeThoughts) === true && !this.config.provider.startsWith(\"google.vertex.\")) {\n      warnings.push({\n        type: \"other\",\n        message: `The 'includeThoughts' option is only supported with the Google Vertex provider and might not be supported or could behave unexpectedly with the current Google provider (${this.config.provider}).`\n      });\n    }\n    const generationConfig = {\n      // standardized settings:\n      maxOutputTokens: maxTokens,\n      temperature,\n      topK,\n      topP,\n      frequencyPenalty,\n      presencePenalty,\n      stopSequences,\n      seed,\n      // response format:\n      responseMimeType: (responseFormat == null ? void 0 : responseFormat.type) === \"json\" ? \"application/json\" : void 0,\n      responseSchema: (responseFormat == null ? void 0 : responseFormat.type) === \"json\" && responseFormat.schema != null && // Google GenAI does not support all OpenAPI Schema features,\n      // so this is needed as an escape hatch:\n      this.supportsStructuredOutputs ? convertJSONSchemaToOpenAPISchema(responseFormat.schema) : void 0,\n      ...this.settings.audioTimestamp && {\n        audioTimestamp: this.settings.audioTimestamp\n      },\n      // provider options:\n      responseModalities: googleOptions == null ? void 0 : googleOptions.responseModalities,\n      thinkingConfig: googleOptions == null ? void 0 : googleOptions.thinkingConfig\n    };\n    const { contents, systemInstruction } = convertToGoogleGenerativeAIMessages(prompt);\n    switch (type) {\n      case \"regular\": {\n        const { tools, toolConfig, toolWarnings } = prepareTools(\n          mode,\n          (_b = this.settings.useSearchGrounding) != null ? _b : false,\n          this.settings.dynamicRetrievalConfig,\n          this.modelId\n        );\n        return {\n          args: {\n            generationConfig,\n            contents,\n            systemInstruction,\n            safetySettings: this.settings.safetySettings,\n            tools,\n            toolConfig,\n            cachedContent: this.settings.cachedContent\n          },\n          warnings: [...warnings, ...toolWarnings]\n        };\n      }\n      case \"object-json\": {\n        return {\n          args: {\n            generationConfig: {\n              ...generationConfig,\n              responseMimeType: \"application/json\",\n              responseSchema: mode.schema != null && // Google GenAI does not support all OpenAPI Schema features,\n              // so this is needed as an escape hatch:\n              this.supportsStructuredOutputs ? convertJSONSchemaToOpenAPISchema(mode.schema) : void 0\n            },\n            contents,\n            systemInstruction,\n            safetySettings: this.settings.safetySettings,\n            cachedContent: this.settings.cachedContent\n          },\n          warnings\n        };\n      }\n      case \"object-tool\": {\n        return {\n          args: {\n            generationConfig,\n            contents,\n            systemInstruction,\n            tools: {\n              functionDeclarations: [\n                {\n                  name: mode.tool.name,\n                  description: (_c = mode.tool.description) != null ? _c : \"\",\n                  parameters: convertJSONSchemaToOpenAPISchema(\n                    mode.tool.parameters\n                  )\n                }\n              ]\n            },\n            toolConfig: { functionCallingConfig: { mode: \"ANY\" } },\n            safetySettings: this.settings.safetySettings,\n            cachedContent: this.settings.cachedContent\n          },\n          warnings\n        };\n      }\n      default: {\n        const _exhaustiveCheck = type;\n        throw new Error(`Unsupported type: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n  supportsUrl(url) {\n    return this.config.isSupportedUrl(url);\n  }\n  async doGenerate(options) {\n    var _a, _b, _c, _d, _e;\n    const { args, warnings } = await this.getArgs(options);\n    const body = JSON.stringify(args);\n    const mergedHeaders = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.combineHeaders)(\n      await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.resolve)(this.config.headers),\n      options.headers\n    );\n    const {\n      responseHeaders,\n      value: response,\n      rawValue: rawResponse\n    } = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.postJsonToApi)({\n      url: `${this.config.baseURL}/${getModelPath(\n        this.modelId\n      )}:generateContent`,\n      headers: mergedHeaders,\n      body: args,\n      failedResponseHandler: googleFailedResponseHandler,\n      successfulResponseHandler: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.createJsonResponseHandler)(responseSchema),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch\n    });\n    const { contents: rawPrompt, ...rawSettings } = args;\n    const candidate = response.candidates[0];\n    const parts = candidate.content == null || typeof candidate.content !== \"object\" || !(\"parts\" in candidate.content) ? [] : candidate.content.parts;\n    const toolCalls = getToolCallsFromParts({\n      parts,\n      // Use candidateParts\n      generateId: this.config.generateId\n    });\n    const usageMetadata = response.usageMetadata;\n    return {\n      text: getTextFromParts(parts),\n      reasoning: getReasoningDetailsFromParts(parts),\n      files: (_a = getInlineDataParts(parts)) == null ? void 0 : _a.map((part) => ({\n        data: part.inlineData.data,\n        mimeType: part.inlineData.mimeType\n      })),\n      toolCalls,\n      finishReason: mapGoogleGenerativeAIFinishReason({\n        finishReason: candidate.finishReason,\n        hasToolCalls: toolCalls != null && toolCalls.length > 0\n      }),\n      usage: {\n        promptTokens: (_b = usageMetadata == null ? void 0 : usageMetadata.promptTokenCount) != null ? _b : NaN,\n        completionTokens: (_c = usageMetadata == null ? void 0 : usageMetadata.candidatesTokenCount) != null ? _c : NaN\n      },\n      rawCall: { rawPrompt, rawSettings },\n      rawResponse: { headers: responseHeaders, body: rawResponse },\n      warnings,\n      providerMetadata: {\n        google: {\n          groundingMetadata: (_d = candidate.groundingMetadata) != null ? _d : null,\n          safetyRatings: (_e = candidate.safetyRatings) != null ? _e : null\n        }\n      },\n      sources: extractSources({\n        groundingMetadata: candidate.groundingMetadata,\n        generateId: this.config.generateId\n      }),\n      request: { body }\n    };\n  }\n  async doStream(options) {\n    const { args, warnings } = await this.getArgs(options);\n    const body = JSON.stringify(args);\n    const headers = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.combineHeaders)(\n      await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.resolve)(this.config.headers),\n      options.headers\n    );\n    const { responseHeaders, value: response } = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.postJsonToApi)({\n      url: `${this.config.baseURL}/${getModelPath(\n        this.modelId\n      )}:streamGenerateContent?alt=sse`,\n      headers,\n      body: args,\n      failedResponseHandler: googleFailedResponseHandler,\n      successfulResponseHandler: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.createEventSourceResponseHandler)(chunkSchema),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch\n    });\n    const { contents: rawPrompt, ...rawSettings } = args;\n    let finishReason = \"unknown\";\n    let usage = {\n      promptTokens: Number.NaN,\n      completionTokens: Number.NaN\n    };\n    let providerMetadata = void 0;\n    const generateId2 = this.config.generateId;\n    let hasToolCalls = false;\n    return {\n      stream: response.pipeThrough(\n        new TransformStream({\n          transform(chunk, controller) {\n            var _a, _b, _c, _d, _e, _f;\n            if (!chunk.success) {\n              controller.enqueue({ type: \"error\", error: chunk.error });\n              return;\n            }\n            const value = chunk.value;\n            const usageMetadata = value.usageMetadata;\n            if (usageMetadata != null) {\n              usage = {\n                promptTokens: (_a = usageMetadata.promptTokenCount) != null ? _a : NaN,\n                completionTokens: (_b = usageMetadata.candidatesTokenCount) != null ? _b : NaN\n              };\n            }\n            const candidate = (_c = value.candidates) == null ? void 0 : _c[0];\n            if (candidate == null) {\n              return;\n            }\n            const content = candidate.content;\n            if (content != null) {\n              const deltaText = getTextFromParts(content.parts);\n              if (deltaText != null) {\n                controller.enqueue({\n                  type: \"text-delta\",\n                  textDelta: deltaText\n                });\n              }\n              const reasoningDeltaText = getReasoningDetailsFromParts(\n                content.parts\n              );\n              if (reasoningDeltaText != null) {\n                for (const part of reasoningDeltaText) {\n                  controller.enqueue({\n                    type: \"reasoning\",\n                    textDelta: part.text\n                  });\n                }\n              }\n              const inlineDataParts = getInlineDataParts(content.parts);\n              if (inlineDataParts != null) {\n                for (const part of inlineDataParts) {\n                  controller.enqueue({\n                    type: \"file\",\n                    mimeType: part.inlineData.mimeType,\n                    data: part.inlineData.data\n                  });\n                }\n              }\n              const toolCallDeltas = getToolCallsFromParts({\n                parts: content.parts,\n                generateId: generateId2\n              });\n              if (toolCallDeltas != null) {\n                for (const toolCall of toolCallDeltas) {\n                  controller.enqueue({\n                    type: \"tool-call-delta\",\n                    toolCallType: \"function\",\n                    toolCallId: toolCall.toolCallId,\n                    toolName: toolCall.toolName,\n                    argsTextDelta: toolCall.args\n                  });\n                  controller.enqueue({\n                    type: \"tool-call\",\n                    toolCallType: \"function\",\n                    toolCallId: toolCall.toolCallId,\n                    toolName: toolCall.toolName,\n                    args: toolCall.args\n                  });\n                  hasToolCalls = true;\n                }\n              }\n            }\n            if (candidate.finishReason != null) {\n              finishReason = mapGoogleGenerativeAIFinishReason({\n                finishReason: candidate.finishReason,\n                hasToolCalls\n              });\n              const sources = (_d = extractSources({\n                groundingMetadata: candidate.groundingMetadata,\n                generateId: generateId2\n              })) != null ? _d : [];\n              for (const source of sources) {\n                controller.enqueue({ type: \"source\", source });\n              }\n              providerMetadata = {\n                google: {\n                  groundingMetadata: (_e = candidate.groundingMetadata) != null ? _e : null,\n                  safetyRatings: (_f = candidate.safetyRatings) != null ? _f : null\n                }\n              };\n            }\n          },\n          flush(controller) {\n            controller.enqueue({\n              type: \"finish\",\n              finishReason,\n              usage,\n              providerMetadata\n            });\n          }\n        })\n      ),\n      rawCall: { rawPrompt, rawSettings },\n      rawResponse: { headers: responseHeaders },\n      warnings,\n      request: { body }\n    };\n  }\n};\nfunction getToolCallsFromParts({\n  parts,\n  generateId: generateId2\n}) {\n  const functionCallParts = parts == null ? void 0 : parts.filter(\n    (part) => \"functionCall\" in part\n  );\n  return functionCallParts == null || functionCallParts.length === 0 ? void 0 : functionCallParts.map((part) => ({\n    toolCallType: \"function\",\n    toolCallId: generateId2(),\n    toolName: part.functionCall.name,\n    args: JSON.stringify(part.functionCall.args)\n  }));\n}\nfunction getTextFromParts(parts) {\n  const textParts = parts == null ? void 0 : parts.filter(\n    (part) => \"text\" in part && part.thought !== true\n  );\n  return textParts == null || textParts.length === 0 ? void 0 : textParts.map((part) => part.text).join(\"\");\n}\nfunction getReasoningDetailsFromParts(parts) {\n  const reasoningParts = parts == null ? void 0 : parts.filter(\n    (part) => \"text\" in part && part.thought === true && part.text != null\n  );\n  return reasoningParts == null || reasoningParts.length === 0 ? void 0 : reasoningParts.map((part) => ({ type: \"text\", text: part.text }));\n}\nfunction getInlineDataParts(parts) {\n  return parts == null ? void 0 : parts.filter(\n    (part) => \"inlineData\" in part\n  );\n}\nfunction extractSources({\n  groundingMetadata,\n  generateId: generateId2\n}) {\n  var _a;\n  return (_a = groundingMetadata == null ? void 0 : groundingMetadata.groundingChunks) == null ? void 0 : _a.filter(\n    (chunk) => chunk.web != null\n  ).map((chunk) => ({\n    sourceType: \"url\",\n    id: generateId2(),\n    url: chunk.web.uri,\n    title: chunk.web.title\n  }));\n}\nvar contentSchema = zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n  parts: zod__WEBPACK_IMPORTED_MODULE_2__.z.array(\n    zod__WEBPACK_IMPORTED_MODULE_2__.z.union([\n      // note: order matters since text can be fully empty\n      zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n        functionCall: zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n          name: zod__WEBPACK_IMPORTED_MODULE_2__.z.string(),\n          args: zod__WEBPACK_IMPORTED_MODULE_2__.z.unknown()\n        })\n      }),\n      zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n        inlineData: zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n          mimeType: zod__WEBPACK_IMPORTED_MODULE_2__.z.string(),\n          data: zod__WEBPACK_IMPORTED_MODULE_2__.z.string()\n        })\n      }),\n      zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n        text: zod__WEBPACK_IMPORTED_MODULE_2__.z.string().nullish(),\n        thought: zod__WEBPACK_IMPORTED_MODULE_2__.z.boolean().nullish()\n      })\n    ])\n  ).nullish()\n});\nvar groundingChunkSchema = zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n  web: zod__WEBPACK_IMPORTED_MODULE_2__.z.object({ uri: zod__WEBPACK_IMPORTED_MODULE_2__.z.string(), title: zod__WEBPACK_IMPORTED_MODULE_2__.z.string() }).nullish(),\n  retrievedContext: zod__WEBPACK_IMPORTED_MODULE_2__.z.object({ uri: zod__WEBPACK_IMPORTED_MODULE_2__.z.string(), title: zod__WEBPACK_IMPORTED_MODULE_2__.z.string() }).nullish()\n});\nvar groundingMetadataSchema = zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n  webSearchQueries: zod__WEBPACK_IMPORTED_MODULE_2__.z.array(zod__WEBPACK_IMPORTED_MODULE_2__.z.string()).nullish(),\n  retrievalQueries: zod__WEBPACK_IMPORTED_MODULE_2__.z.array(zod__WEBPACK_IMPORTED_MODULE_2__.z.string()).nullish(),\n  searchEntryPoint: zod__WEBPACK_IMPORTED_MODULE_2__.z.object({ renderedContent: zod__WEBPACK_IMPORTED_MODULE_2__.z.string() }).nullish(),\n  groundingChunks: zod__WEBPACK_IMPORTED_MODULE_2__.z.array(groundingChunkSchema).nullish(),\n  groundingSupports: zod__WEBPACK_IMPORTED_MODULE_2__.z.array(\n    zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n      segment: zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n        startIndex: zod__WEBPACK_IMPORTED_MODULE_2__.z.number().nullish(),\n        endIndex: zod__WEBPACK_IMPORTED_MODULE_2__.z.number().nullish(),\n        text: zod__WEBPACK_IMPORTED_MODULE_2__.z.string().nullish()\n      }),\n      segment_text: zod__WEBPACK_IMPORTED_MODULE_2__.z.string().nullish(),\n      groundingChunkIndices: zod__WEBPACK_IMPORTED_MODULE_2__.z.array(zod__WEBPACK_IMPORTED_MODULE_2__.z.number()).nullish(),\n      supportChunkIndices: zod__WEBPACK_IMPORTED_MODULE_2__.z.array(zod__WEBPACK_IMPORTED_MODULE_2__.z.number()).nullish(),\n      confidenceScores: zod__WEBPACK_IMPORTED_MODULE_2__.z.array(zod__WEBPACK_IMPORTED_MODULE_2__.z.number()).nullish(),\n      confidenceScore: zod__WEBPACK_IMPORTED_MODULE_2__.z.array(zod__WEBPACK_IMPORTED_MODULE_2__.z.number()).nullish()\n    })\n  ).nullish(),\n  retrievalMetadata: zod__WEBPACK_IMPORTED_MODULE_2__.z.union([\n    zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n      webDynamicRetrievalScore: zod__WEBPACK_IMPORTED_MODULE_2__.z.number()\n    }),\n    zod__WEBPACK_IMPORTED_MODULE_2__.z.object({})\n  ]).nullish()\n});\nvar safetyRatingSchema = zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n  category: zod__WEBPACK_IMPORTED_MODULE_2__.z.string().nullish(),\n  probability: zod__WEBPACK_IMPORTED_MODULE_2__.z.string().nullish(),\n  probabilityScore: zod__WEBPACK_IMPORTED_MODULE_2__.z.number().nullish(),\n  severity: zod__WEBPACK_IMPORTED_MODULE_2__.z.string().nullish(),\n  severityScore: zod__WEBPACK_IMPORTED_MODULE_2__.z.number().nullish(),\n  blocked: zod__WEBPACK_IMPORTED_MODULE_2__.z.boolean().nullish()\n});\nvar responseSchema = zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n  candidates: zod__WEBPACK_IMPORTED_MODULE_2__.z.array(\n    zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n      content: contentSchema.nullish().or(zod__WEBPACK_IMPORTED_MODULE_2__.z.object({}).strict()),\n      finishReason: zod__WEBPACK_IMPORTED_MODULE_2__.z.string().nullish(),\n      safetyRatings: zod__WEBPACK_IMPORTED_MODULE_2__.z.array(safetyRatingSchema).nullish(),\n      groundingMetadata: groundingMetadataSchema.nullish()\n    })\n  ),\n  usageMetadata: zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n    promptTokenCount: zod__WEBPACK_IMPORTED_MODULE_2__.z.number().nullish(),\n    candidatesTokenCount: zod__WEBPACK_IMPORTED_MODULE_2__.z.number().nullish(),\n    totalTokenCount: zod__WEBPACK_IMPORTED_MODULE_2__.z.number().nullish()\n  }).nullish()\n});\nvar chunkSchema = zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n  candidates: zod__WEBPACK_IMPORTED_MODULE_2__.z.array(\n    zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n      content: contentSchema.nullish(),\n      finishReason: zod__WEBPACK_IMPORTED_MODULE_2__.z.string().nullish(),\n      safetyRatings: zod__WEBPACK_IMPORTED_MODULE_2__.z.array(safetyRatingSchema).nullish(),\n      groundingMetadata: groundingMetadataSchema.nullish()\n    })\n  ).nullish(),\n  usageMetadata: zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n    promptTokenCount: zod__WEBPACK_IMPORTED_MODULE_2__.z.number().nullish(),\n    candidatesTokenCount: zod__WEBPACK_IMPORTED_MODULE_2__.z.number().nullish(),\n    totalTokenCount: zod__WEBPACK_IMPORTED_MODULE_2__.z.number().nullish()\n  }).nullish()\n});\nvar googleGenerativeAIProviderOptionsSchema = zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n  responseModalities: zod__WEBPACK_IMPORTED_MODULE_2__.z.array(zod__WEBPACK_IMPORTED_MODULE_2__.z.enum([\"TEXT\", \"IMAGE\"])).nullish(),\n  thinkingConfig: zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n    thinkingBudget: zod__WEBPACK_IMPORTED_MODULE_2__.z.number().nullish(),\n    includeThoughts: zod__WEBPACK_IMPORTED_MODULE_2__.z.boolean().nullish()\n  }).nullish()\n});\n\n// src/google-generative-ai-embedding-model.ts\n\n\n\nvar GoogleGenerativeAIEmbeddingModel = class {\n  constructor(modelId, settings, config) {\n    this.specificationVersion = \"v1\";\n    this.modelId = modelId;\n    this.settings = settings;\n    this.config = config;\n  }\n  get provider() {\n    return this.config.provider;\n  }\n  get maxEmbeddingsPerCall() {\n    return 2048;\n  }\n  get supportsParallelCalls() {\n    return true;\n  }\n  async doEmbed({\n    values,\n    headers,\n    abortSignal\n  }) {\n    if (values.length > this.maxEmbeddingsPerCall) {\n      throw new _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_0__.TooManyEmbeddingValuesForCallError({\n        provider: this.provider,\n        modelId: this.modelId,\n        maxEmbeddingsPerCall: this.maxEmbeddingsPerCall,\n        values\n      });\n    }\n    const mergedHeaders = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.combineHeaders)(\n      await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.resolve)(this.config.headers),\n      headers\n    );\n    const { responseHeaders, value: response } = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.postJsonToApi)({\n      url: `${this.config.baseURL}/models/${this.modelId}:batchEmbedContents`,\n      headers: mergedHeaders,\n      body: {\n        requests: values.map((value) => ({\n          model: `models/${this.modelId}`,\n          content: { role: \"user\", parts: [{ text: value }] },\n          outputDimensionality: this.settings.outputDimensionality,\n          taskType: this.settings.taskType\n        }))\n      },\n      failedResponseHandler: googleFailedResponseHandler,\n      successfulResponseHandler: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.createJsonResponseHandler)(\n        googleGenerativeAITextEmbeddingResponseSchema\n      ),\n      abortSignal,\n      fetch: this.config.fetch\n    });\n    return {\n      embeddings: response.embeddings.map((item) => item.values),\n      usage: void 0,\n      rawResponse: { headers: responseHeaders }\n    };\n  }\n};\nvar googleGenerativeAITextEmbeddingResponseSchema = zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n  embeddings: zod__WEBPACK_IMPORTED_MODULE_2__.z.array(zod__WEBPACK_IMPORTED_MODULE_2__.z.object({ values: zod__WEBPACK_IMPORTED_MODULE_2__.z.array(zod__WEBPACK_IMPORTED_MODULE_2__.z.number()) }))\n});\n\n// src/google-supported-file-url.ts\nfunction isSupportedFileUrl(url) {\n  return url.toString().startsWith(\"https://generativelanguage.googleapis.com/v1beta/files/\");\n}\n\n// src/google-provider.ts\nfunction createGoogleGenerativeAI(options = {}) {\n  var _a;\n  const baseURL = (_a = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.withoutTrailingSlash)(options.baseURL)) != null ? _a : \"https://generativelanguage.googleapis.com/v1beta\";\n  const getHeaders = () => ({\n    \"x-goog-api-key\": (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.loadApiKey)({\n      apiKey: options.apiKey,\n      environmentVariableName: \"GOOGLE_GENERATIVE_AI_API_KEY\",\n      description: \"Google Generative AI\"\n    }),\n    ...options.headers\n  });\n  const createChatModel = (modelId, settings = {}) => {\n    var _a2;\n    return new GoogleGenerativeAILanguageModel(modelId, settings, {\n      provider: \"google.generative-ai\",\n      baseURL,\n      headers: getHeaders,\n      generateId: (_a2 = options.generateId) != null ? _a2 : _ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.generateId,\n      isSupportedUrl: isSupportedFileUrl,\n      fetch: options.fetch\n    });\n  };\n  const createEmbeddingModel = (modelId, settings = {}) => new GoogleGenerativeAIEmbeddingModel(modelId, settings, {\n    provider: \"google.generative-ai\",\n    baseURL,\n    headers: getHeaders,\n    fetch: options.fetch\n  });\n  const provider = function(modelId, settings) {\n    if (new.target) {\n      throw new Error(\n        \"The Google Generative AI model function cannot be called with the new keyword.\"\n      );\n    }\n    return createChatModel(modelId, settings);\n  };\n  provider.languageModel = createChatModel;\n  provider.chat = createChatModel;\n  provider.generativeAI = createChatModel;\n  provider.embedding = createEmbeddingModel;\n  provider.textEmbedding = createEmbeddingModel;\n  provider.textEmbeddingModel = createEmbeddingModel;\n  return provider;\n}\nvar google = createGoogleGenerativeAI();\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vQGFpLXNkaytnb29nbGVAMS4yLjIyX3pvZEAzLjI0LjIvbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ29vZ2xlL2Rpc3QvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7QUFLZ0M7O0FBRWhDO0FBUWdDO0FBQ0Y7O0FBRTlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFHMEI7QUFDeUM7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwyRUFBNkI7QUFDakQ7QUFDQSxXQUFXO0FBQ1g7QUFDQSxzQ0FBc0MsZUFBZTtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLGlCQUFpQjtBQUM1QztBQUNB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QjtBQUNBO0FBQ0E7QUFDQSxvREFBb0Qsa0NBQUU7QUFDdEQsY0FBYyxrQ0FBRSxPQUFPLGtDQUFFLFVBQVUsUUFBUSxrQ0FBRSxPQUFPLGtDQUFFLFlBQVk7QUFDbEUsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDhDQUE4QztBQUM5QztBQUNBLHdCQUF3Qiw0RUFBb0I7QUFDNUM7QUFDQSxzQkFBc0Isa0VBQVU7QUFDaEM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNILGlEQUFpRDtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkRBQTZELDhEQUFVO0FBQ3ZFO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxzREFBc0Q7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlFO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9mYXJ6YWRmZXJkb3VzL0Rlc2t0b3AvcG9ydGZvbGlvL25vZGVfbW9kdWxlcy8ucG5wbS9AYWktc2RrK2dvb2dsZUAxLjIuMjJfem9kQDMuMjQuMi9ub2RlX21vZHVsZXMvQGFpLXNkay9nb29nbGUvZGlzdC9pbmRleC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL2dvb2dsZS1wcm92aWRlci50c1xuaW1wb3J0IHtcbiAgZ2VuZXJhdGVJZCxcbiAgbG9hZEFwaUtleSxcbiAgd2l0aG91dFRyYWlsaW5nU2xhc2hcbn0gZnJvbSBcIkBhaS1zZGsvcHJvdmlkZXItdXRpbHNcIjtcblxuLy8gc3JjL2dvb2dsZS1nZW5lcmF0aXZlLWFpLWxhbmd1YWdlLW1vZGVsLnRzXG5pbXBvcnQge1xuICBjb21iaW5lSGVhZGVycyxcbiAgY3JlYXRlRXZlbnRTb3VyY2VSZXNwb25zZUhhbmRsZXIsXG4gIGNyZWF0ZUpzb25SZXNwb25zZUhhbmRsZXIsXG4gIHBhcnNlUHJvdmlkZXJPcHRpb25zLFxuICBwb3N0SnNvblRvQXBpLFxuICByZXNvbHZlXG59IGZyb20gXCJAYWktc2RrL3Byb3ZpZGVyLXV0aWxzXCI7XG5pbXBvcnQgeyB6IGFzIHoyIH0gZnJvbSBcInpvZFwiO1xuXG4vLyBzcmMvY29udmVydC1qc29uLXNjaGVtYS10by1vcGVuYXBpLXNjaGVtYS50c1xuZnVuY3Rpb24gY29udmVydEpTT05TY2hlbWFUb09wZW5BUElTY2hlbWEoanNvblNjaGVtYSkge1xuICBpZiAoaXNFbXB0eU9iamVjdFNjaGVtYShqc29uU2NoZW1hKSkge1xuICAgIHJldHVybiB2b2lkIDA7XG4gIH1cbiAgaWYgKHR5cGVvZiBqc29uU2NoZW1hID09PSBcImJvb2xlYW5cIikge1xuICAgIHJldHVybiB7IHR5cGU6IFwiYm9vbGVhblwiLCBwcm9wZXJ0aWVzOiB7fSB9O1xuICB9XG4gIGNvbnN0IHtcbiAgICB0eXBlLFxuICAgIGRlc2NyaXB0aW9uLFxuICAgIHJlcXVpcmVkLFxuICAgIHByb3BlcnRpZXMsXG4gICAgaXRlbXMsXG4gICAgYWxsT2YsXG4gICAgYW55T2YsXG4gICAgb25lT2YsXG4gICAgZm9ybWF0LFxuICAgIGNvbnN0OiBjb25zdFZhbHVlLFxuICAgIG1pbkxlbmd0aCxcbiAgICBlbnVtOiBlbnVtVmFsdWVzXG4gIH0gPSBqc29uU2NoZW1hO1xuICBjb25zdCByZXN1bHQgPSB7fTtcbiAgaWYgKGRlc2NyaXB0aW9uKVxuICAgIHJlc3VsdC5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICBpZiAocmVxdWlyZWQpXG4gICAgcmVzdWx0LnJlcXVpcmVkID0gcmVxdWlyZWQ7XG4gIGlmIChmb3JtYXQpXG4gICAgcmVzdWx0LmZvcm1hdCA9IGZvcm1hdDtcbiAgaWYgKGNvbnN0VmFsdWUgIT09IHZvaWQgMCkge1xuICAgIHJlc3VsdC5lbnVtID0gW2NvbnN0VmFsdWVdO1xuICB9XG4gIGlmICh0eXBlKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkodHlwZSkpIHtcbiAgICAgIGlmICh0eXBlLmluY2x1ZGVzKFwibnVsbFwiKSkge1xuICAgICAgICByZXN1bHQudHlwZSA9IHR5cGUuZmlsdGVyKCh0KSA9PiB0ICE9PSBcIm51bGxcIilbMF07XG4gICAgICAgIHJlc3VsdC5udWxsYWJsZSA9IHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQudHlwZSA9IHR5cGU7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSBcIm51bGxcIikge1xuICAgICAgcmVzdWx0LnR5cGUgPSBcIm51bGxcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0LnR5cGUgPSB0eXBlO1xuICAgIH1cbiAgfVxuICBpZiAoZW51bVZhbHVlcyAhPT0gdm9pZCAwKSB7XG4gICAgcmVzdWx0LmVudW0gPSBlbnVtVmFsdWVzO1xuICB9XG4gIGlmIChwcm9wZXJ0aWVzICE9IG51bGwpIHtcbiAgICByZXN1bHQucHJvcGVydGllcyA9IE9iamVjdC5lbnRyaWVzKHByb3BlcnRpZXMpLnJlZHVjZShcbiAgICAgIChhY2MsIFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgICBhY2Nba2V5XSA9IGNvbnZlcnRKU09OU2NoZW1hVG9PcGVuQVBJU2NoZW1hKHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgIH0sXG4gICAgICB7fVxuICAgICk7XG4gIH1cbiAgaWYgKGl0ZW1zKSB7XG4gICAgcmVzdWx0Lml0ZW1zID0gQXJyYXkuaXNBcnJheShpdGVtcykgPyBpdGVtcy5tYXAoY29udmVydEpTT05TY2hlbWFUb09wZW5BUElTY2hlbWEpIDogY29udmVydEpTT05TY2hlbWFUb09wZW5BUElTY2hlbWEoaXRlbXMpO1xuICB9XG4gIGlmIChhbGxPZikge1xuICAgIHJlc3VsdC5hbGxPZiA9IGFsbE9mLm1hcChjb252ZXJ0SlNPTlNjaGVtYVRvT3BlbkFQSVNjaGVtYSk7XG4gIH1cbiAgaWYgKGFueU9mKSB7XG4gICAgaWYgKGFueU9mLnNvbWUoXG4gICAgICAoc2NoZW1hKSA9PiB0eXBlb2Ygc2NoZW1hID09PSBcIm9iamVjdFwiICYmIChzY2hlbWEgPT0gbnVsbCA/IHZvaWQgMCA6IHNjaGVtYS50eXBlKSA9PT0gXCJudWxsXCJcbiAgICApKSB7XG4gICAgICBjb25zdCBub25OdWxsU2NoZW1hcyA9IGFueU9mLmZpbHRlcihcbiAgICAgICAgKHNjaGVtYSkgPT4gISh0eXBlb2Ygc2NoZW1hID09PSBcIm9iamVjdFwiICYmIChzY2hlbWEgPT0gbnVsbCA/IHZvaWQgMCA6IHNjaGVtYS50eXBlKSA9PT0gXCJudWxsXCIpXG4gICAgICApO1xuICAgICAgaWYgKG5vbk51bGxTY2hlbWFzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICBjb25zdCBjb252ZXJ0ZWQgPSBjb252ZXJ0SlNPTlNjaGVtYVRvT3BlbkFQSVNjaGVtYShub25OdWxsU2NoZW1hc1swXSk7XG4gICAgICAgIGlmICh0eXBlb2YgY29udmVydGVkID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgcmVzdWx0Lm51bGxhYmxlID0gdHJ1ZTtcbiAgICAgICAgICBPYmplY3QuYXNzaWduKHJlc3VsdCwgY29udmVydGVkKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0LmFueU9mID0gbm9uTnVsbFNjaGVtYXMubWFwKGNvbnZlcnRKU09OU2NoZW1hVG9PcGVuQVBJU2NoZW1hKTtcbiAgICAgICAgcmVzdWx0Lm51bGxhYmxlID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0LmFueU9mID0gYW55T2YubWFwKGNvbnZlcnRKU09OU2NoZW1hVG9PcGVuQVBJU2NoZW1hKTtcbiAgICB9XG4gIH1cbiAgaWYgKG9uZU9mKSB7XG4gICAgcmVzdWx0Lm9uZU9mID0gb25lT2YubWFwKGNvbnZlcnRKU09OU2NoZW1hVG9PcGVuQVBJU2NoZW1hKTtcbiAgfVxuICBpZiAobWluTGVuZ3RoICE9PSB2b2lkIDApIHtcbiAgICByZXN1bHQubWluTGVuZ3RoID0gbWluTGVuZ3RoO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBpc0VtcHR5T2JqZWN0U2NoZW1hKGpzb25TY2hlbWEpIHtcbiAgcmV0dXJuIGpzb25TY2hlbWEgIT0gbnVsbCAmJiB0eXBlb2YganNvblNjaGVtYSA9PT0gXCJvYmplY3RcIiAmJiBqc29uU2NoZW1hLnR5cGUgPT09IFwib2JqZWN0XCIgJiYgKGpzb25TY2hlbWEucHJvcGVydGllcyA9PSBudWxsIHx8IE9iamVjdC5rZXlzKGpzb25TY2hlbWEucHJvcGVydGllcykubGVuZ3RoID09PSAwKSAmJiAhanNvblNjaGVtYS5hZGRpdGlvbmFsUHJvcGVydGllcztcbn1cblxuLy8gc3JjL2NvbnZlcnQtdG8tZ29vZ2xlLWdlbmVyYXRpdmUtYWktbWVzc2FnZXMudHNcbmltcG9ydCB7XG4gIFVuc3VwcG9ydGVkRnVuY3Rpb25hbGl0eUVycm9yXG59IGZyb20gXCJAYWktc2RrL3Byb3ZpZGVyXCI7XG5pbXBvcnQgeyBjb252ZXJ0VWludDhBcnJheVRvQmFzZTY0IH0gZnJvbSBcIkBhaS1zZGsvcHJvdmlkZXItdXRpbHNcIjtcbmZ1bmN0aW9uIGNvbnZlcnRUb0dvb2dsZUdlbmVyYXRpdmVBSU1lc3NhZ2VzKHByb21wdCkge1xuICB2YXIgX2EsIF9iO1xuICBjb25zdCBzeXN0ZW1JbnN0cnVjdGlvblBhcnRzID0gW107XG4gIGNvbnN0IGNvbnRlbnRzID0gW107XG4gIGxldCBzeXN0ZW1NZXNzYWdlc0FsbG93ZWQgPSB0cnVlO1xuICBmb3IgKGNvbnN0IHsgcm9sZSwgY29udGVudCB9IG9mIHByb21wdCkge1xuICAgIHN3aXRjaCAocm9sZSkge1xuICAgICAgY2FzZSBcInN5c3RlbVwiOiB7XG4gICAgICAgIGlmICghc3lzdGVtTWVzc2FnZXNBbGxvd2VkKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkRnVuY3Rpb25hbGl0eUVycm9yKHtcbiAgICAgICAgICAgIGZ1bmN0aW9uYWxpdHk6IFwic3lzdGVtIG1lc3NhZ2VzIGFyZSBvbmx5IHN1cHBvcnRlZCBhdCB0aGUgYmVnaW5uaW5nIG9mIHRoZSBjb252ZXJzYXRpb25cIlxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHN5c3RlbUluc3RydWN0aW9uUGFydHMucHVzaCh7IHRleHQ6IGNvbnRlbnQgfSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSBcInVzZXJcIjoge1xuICAgICAgICBzeXN0ZW1NZXNzYWdlc0FsbG93ZWQgPSBmYWxzZTtcbiAgICAgICAgY29uc3QgcGFydHMgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBwYXJ0IG9mIGNvbnRlbnQpIHtcbiAgICAgICAgICBzd2l0Y2ggKHBhcnQudHlwZSkge1xuICAgICAgICAgICAgY2FzZSBcInRleHRcIjoge1xuICAgICAgICAgICAgICBwYXJ0cy5wdXNoKHsgdGV4dDogcGFydC50ZXh0IH0pO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgXCJpbWFnZVwiOiB7XG4gICAgICAgICAgICAgIHBhcnRzLnB1c2goXG4gICAgICAgICAgICAgICAgcGFydC5pbWFnZSBpbnN0YW5jZW9mIFVSTCA/IHtcbiAgICAgICAgICAgICAgICAgIGZpbGVEYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIG1pbWVUeXBlOiAoX2EgPSBwYXJ0Lm1pbWVUeXBlKSAhPSBudWxsID8gX2EgOiBcImltYWdlL2pwZWdcIixcbiAgICAgICAgICAgICAgICAgICAgZmlsZVVyaTogcGFydC5pbWFnZS50b1N0cmluZygpXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSA6IHtcbiAgICAgICAgICAgICAgICAgIGlubGluZURhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgbWltZVR5cGU6IChfYiA9IHBhcnQubWltZVR5cGUpICE9IG51bGwgPyBfYiA6IFwiaW1hZ2UvanBlZ1wiLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBjb252ZXJ0VWludDhBcnJheVRvQmFzZTY0KHBhcnQuaW1hZ2UpXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgXCJmaWxlXCI6IHtcbiAgICAgICAgICAgICAgcGFydHMucHVzaChcbiAgICAgICAgICAgICAgICBwYXJ0LmRhdGEgaW5zdGFuY2VvZiBVUkwgPyB7XG4gICAgICAgICAgICAgICAgICBmaWxlRGF0YToge1xuICAgICAgICAgICAgICAgICAgICBtaW1lVHlwZTogcGFydC5taW1lVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgZmlsZVVyaTogcGFydC5kYXRhLnRvU3RyaW5nKClcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IDoge1xuICAgICAgICAgICAgICAgICAgaW5saW5lRGF0YToge1xuICAgICAgICAgICAgICAgICAgICBtaW1lVHlwZTogcGFydC5taW1lVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogcGFydC5kYXRhXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29udGVudHMucHVzaCh7IHJvbGU6IFwidXNlclwiLCBwYXJ0cyB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlIFwiYXNzaXN0YW50XCI6IHtcbiAgICAgICAgc3lzdGVtTWVzc2FnZXNBbGxvd2VkID0gZmFsc2U7XG4gICAgICAgIGNvbnRlbnRzLnB1c2goe1xuICAgICAgICAgIHJvbGU6IFwibW9kZWxcIixcbiAgICAgICAgICBwYXJ0czogY29udGVudC5tYXAoKHBhcnQpID0+IHtcbiAgICAgICAgICAgIHN3aXRjaCAocGFydC50eXBlKSB7XG4gICAgICAgICAgICAgIGNhc2UgXCJ0ZXh0XCI6IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFydC50ZXh0Lmxlbmd0aCA9PT0gMCA/IHZvaWQgMCA6IHsgdGV4dDogcGFydC50ZXh0IH07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgY2FzZSBcImZpbGVcIjoge1xuICAgICAgICAgICAgICAgIGlmIChwYXJ0Lm1pbWVUeXBlICE9PSBcImltYWdlL3BuZ1wiKSB7XG4gICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRGdW5jdGlvbmFsaXR5RXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbmFsaXR5OiBcIk9ubHkgUE5HIGltYWdlcyBhcmUgc3VwcG9ydGVkIGluIGFzc2lzdGFudCBtZXNzYWdlc1wiXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHBhcnQuZGF0YSBpbnN0YW5jZW9mIFVSTCkge1xuICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkRnVuY3Rpb25hbGl0eUVycm9yKHtcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb25hbGl0eTogXCJGaWxlIGRhdGEgVVJMcyBpbiBhc3Npc3RhbnQgbWVzc2FnZXMgYXJlIG5vdCBzdXBwb3J0ZWRcIlxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICBpbmxpbmVEYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIG1pbWVUeXBlOiBwYXJ0Lm1pbWVUeXBlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBwYXJ0LmRhdGFcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNhc2UgXCJ0b29sLWNhbGxcIjoge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICBmdW5jdGlvbkNhbGw6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogcGFydC50b29sTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgYXJnczogcGFydC5hcmdzXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pLmZpbHRlcigocGFydCkgPT4gcGFydCAhPT0gdm9pZCAwKVxuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlIFwidG9vbFwiOiB7XG4gICAgICAgIHN5c3RlbU1lc3NhZ2VzQWxsb3dlZCA9IGZhbHNlO1xuICAgICAgICBjb250ZW50cy5wdXNoKHtcbiAgICAgICAgICByb2xlOiBcInVzZXJcIixcbiAgICAgICAgICBwYXJ0czogY29udGVudC5tYXAoKHBhcnQpID0+ICh7XG4gICAgICAgICAgICBmdW5jdGlvblJlc3BvbnNlOiB7XG4gICAgICAgICAgICAgIG5hbWU6IHBhcnQudG9vbE5hbWUsXG4gICAgICAgICAgICAgIHJlc3BvbnNlOiB7XG4gICAgICAgICAgICAgICAgbmFtZTogcGFydC50b29sTmFtZSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiBwYXJ0LnJlc3VsdFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSkpXG4gICAgICAgIH0pO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBzeXN0ZW1JbnN0cnVjdGlvbjogc3lzdGVtSW5zdHJ1Y3Rpb25QYXJ0cy5sZW5ndGggPiAwID8geyBwYXJ0czogc3lzdGVtSW5zdHJ1Y3Rpb25QYXJ0cyB9IDogdm9pZCAwLFxuICAgIGNvbnRlbnRzXG4gIH07XG59XG5cbi8vIHNyYy9nZXQtbW9kZWwtcGF0aC50c1xuZnVuY3Rpb24gZ2V0TW9kZWxQYXRoKG1vZGVsSWQpIHtcbiAgcmV0dXJuIG1vZGVsSWQuaW5jbHVkZXMoXCIvXCIpID8gbW9kZWxJZCA6IGBtb2RlbHMvJHttb2RlbElkfWA7XG59XG5cbi8vIHNyYy9nb29nbGUtZXJyb3IudHNcbmltcG9ydCB7IGNyZWF0ZUpzb25FcnJvclJlc3BvbnNlSGFuZGxlciB9IGZyb20gXCJAYWktc2RrL3Byb3ZpZGVyLXV0aWxzXCI7XG5pbXBvcnQgeyB6IH0gZnJvbSBcInpvZFwiO1xudmFyIGdvb2dsZUVycm9yRGF0YVNjaGVtYSA9IHoub2JqZWN0KHtcbiAgZXJyb3I6IHoub2JqZWN0KHtcbiAgICBjb2RlOiB6Lm51bWJlcigpLm51bGxhYmxlKCksXG4gICAgbWVzc2FnZTogei5zdHJpbmcoKSxcbiAgICBzdGF0dXM6IHouc3RyaW5nKClcbiAgfSlcbn0pO1xudmFyIGdvb2dsZUZhaWxlZFJlc3BvbnNlSGFuZGxlciA9IGNyZWF0ZUpzb25FcnJvclJlc3BvbnNlSGFuZGxlcih7XG4gIGVycm9yU2NoZW1hOiBnb29nbGVFcnJvckRhdGFTY2hlbWEsXG4gIGVycm9yVG9NZXNzYWdlOiAoZGF0YSkgPT4gZGF0YS5lcnJvci5tZXNzYWdlXG59KTtcblxuLy8gc3JjL2dvb2dsZS1wcmVwYXJlLXRvb2xzLnRzXG5pbXBvcnQge1xuICBVbnN1cHBvcnRlZEZ1bmN0aW9uYWxpdHlFcnJvciBhcyBVbnN1cHBvcnRlZEZ1bmN0aW9uYWxpdHlFcnJvcjJcbn0gZnJvbSBcIkBhaS1zZGsvcHJvdmlkZXJcIjtcbmZ1bmN0aW9uIHByZXBhcmVUb29scyhtb2RlLCB1c2VTZWFyY2hHcm91bmRpbmcsIGR5bmFtaWNSZXRyaWV2YWxDb25maWcsIG1vZGVsSWQpIHtcbiAgdmFyIF9hLCBfYjtcbiAgY29uc3QgdG9vbHMgPSAoKF9hID0gbW9kZS50b29scykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmxlbmd0aCkgPyBtb2RlLnRvb2xzIDogdm9pZCAwO1xuICBjb25zdCB0b29sV2FybmluZ3MgPSBbXTtcbiAgY29uc3QgaXNHZW1pbmkyID0gbW9kZWxJZC5pbmNsdWRlcyhcImdlbWluaS0yXCIpO1xuICBjb25zdCBzdXBwb3J0c0R5bmFtaWNSZXRyaWV2YWwgPSBtb2RlbElkLmluY2x1ZGVzKFwiZ2VtaW5pLTEuNS1mbGFzaFwiKSAmJiAhbW9kZWxJZC5pbmNsdWRlcyhcIi04YlwiKTtcbiAgaWYgKHVzZVNlYXJjaEdyb3VuZGluZykge1xuICAgIHJldHVybiB7XG4gICAgICB0b29sczogaXNHZW1pbmkyID8geyBnb29nbGVTZWFyY2g6IHt9IH0gOiB7XG4gICAgICAgIGdvb2dsZVNlYXJjaFJldHJpZXZhbDogIXN1cHBvcnRzRHluYW1pY1JldHJpZXZhbCB8fCAhZHluYW1pY1JldHJpZXZhbENvbmZpZyA/IHt9IDogeyBkeW5hbWljUmV0cmlldmFsQ29uZmlnIH1cbiAgICAgIH0sXG4gICAgICB0b29sQ29uZmlnOiB2b2lkIDAsXG4gICAgICB0b29sV2FybmluZ3NcbiAgICB9O1xuICB9XG4gIGlmICh0b29scyA9PSBudWxsKSB7XG4gICAgcmV0dXJuIHsgdG9vbHM6IHZvaWQgMCwgdG9vbENvbmZpZzogdm9pZCAwLCB0b29sV2FybmluZ3MgfTtcbiAgfVxuICBjb25zdCBmdW5jdGlvbkRlY2xhcmF0aW9ucyA9IFtdO1xuICBmb3IgKGNvbnN0IHRvb2wgb2YgdG9vbHMpIHtcbiAgICBpZiAodG9vbC50eXBlID09PSBcInByb3ZpZGVyLWRlZmluZWRcIikge1xuICAgICAgdG9vbFdhcm5pbmdzLnB1c2goeyB0eXBlOiBcInVuc3VwcG9ydGVkLXRvb2xcIiwgdG9vbCB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgZnVuY3Rpb25EZWNsYXJhdGlvbnMucHVzaCh7XG4gICAgICAgIG5hbWU6IHRvb2wubmFtZSxcbiAgICAgICAgZGVzY3JpcHRpb246IChfYiA9IHRvb2wuZGVzY3JpcHRpb24pICE9IG51bGwgPyBfYiA6IFwiXCIsXG4gICAgICAgIHBhcmFtZXRlcnM6IGNvbnZlcnRKU09OU2NoZW1hVG9PcGVuQVBJU2NoZW1hKHRvb2wucGFyYW1ldGVycylcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICBjb25zdCB0b29sQ2hvaWNlID0gbW9kZS50b29sQ2hvaWNlO1xuICBpZiAodG9vbENob2ljZSA9PSBudWxsKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRvb2xzOiB7IGZ1bmN0aW9uRGVjbGFyYXRpb25zIH0sXG4gICAgICB0b29sQ29uZmlnOiB2b2lkIDAsXG4gICAgICB0b29sV2FybmluZ3NcbiAgICB9O1xuICB9XG4gIGNvbnN0IHR5cGUgPSB0b29sQ2hvaWNlLnR5cGU7XG4gIHN3aXRjaCAodHlwZSkge1xuICAgIGNhc2UgXCJhdXRvXCI6XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0b29sczogeyBmdW5jdGlvbkRlY2xhcmF0aW9ucyB9LFxuICAgICAgICB0b29sQ29uZmlnOiB7IGZ1bmN0aW9uQ2FsbGluZ0NvbmZpZzogeyBtb2RlOiBcIkFVVE9cIiB9IH0sXG4gICAgICAgIHRvb2xXYXJuaW5nc1xuICAgICAgfTtcbiAgICBjYXNlIFwibm9uZVwiOlxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdG9vbHM6IHsgZnVuY3Rpb25EZWNsYXJhdGlvbnMgfSxcbiAgICAgICAgdG9vbENvbmZpZzogeyBmdW5jdGlvbkNhbGxpbmdDb25maWc6IHsgbW9kZTogXCJOT05FXCIgfSB9LFxuICAgICAgICB0b29sV2FybmluZ3NcbiAgICAgIH07XG4gICAgY2FzZSBcInJlcXVpcmVkXCI6XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0b29sczogeyBmdW5jdGlvbkRlY2xhcmF0aW9ucyB9LFxuICAgICAgICB0b29sQ29uZmlnOiB7IGZ1bmN0aW9uQ2FsbGluZ0NvbmZpZzogeyBtb2RlOiBcIkFOWVwiIH0gfSxcbiAgICAgICAgdG9vbFdhcm5pbmdzXG4gICAgICB9O1xuICAgIGNhc2UgXCJ0b29sXCI6XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0b29sczogeyBmdW5jdGlvbkRlY2xhcmF0aW9ucyB9LFxuICAgICAgICB0b29sQ29uZmlnOiB7XG4gICAgICAgICAgZnVuY3Rpb25DYWxsaW5nQ29uZmlnOiB7XG4gICAgICAgICAgICBtb2RlOiBcIkFOWVwiLFxuICAgICAgICAgICAgYWxsb3dlZEZ1bmN0aW9uTmFtZXM6IFt0b29sQ2hvaWNlLnRvb2xOYW1lXVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgdG9vbFdhcm5pbmdzXG4gICAgICB9O1xuICAgIGRlZmF1bHQ6IHtcbiAgICAgIGNvbnN0IF9leGhhdXN0aXZlQ2hlY2sgPSB0eXBlO1xuICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkRnVuY3Rpb25hbGl0eUVycm9yMih7XG4gICAgICAgIGZ1bmN0aW9uYWxpdHk6IGBVbnN1cHBvcnRlZCB0b29sIGNob2ljZSB0eXBlOiAke19leGhhdXN0aXZlQ2hlY2t9YFxuICAgICAgfSk7XG4gICAgfVxuICB9XG59XG5cbi8vIHNyYy9tYXAtZ29vZ2xlLWdlbmVyYXRpdmUtYWktZmluaXNoLXJlYXNvbi50c1xuZnVuY3Rpb24gbWFwR29vZ2xlR2VuZXJhdGl2ZUFJRmluaXNoUmVhc29uKHtcbiAgZmluaXNoUmVhc29uLFxuICBoYXNUb29sQ2FsbHNcbn0pIHtcbiAgc3dpdGNoIChmaW5pc2hSZWFzb24pIHtcbiAgICBjYXNlIFwiU1RPUFwiOlxuICAgICAgcmV0dXJuIGhhc1Rvb2xDYWxscyA/IFwidG9vbC1jYWxsc1wiIDogXCJzdG9wXCI7XG4gICAgY2FzZSBcIk1BWF9UT0tFTlNcIjpcbiAgICAgIHJldHVybiBcImxlbmd0aFwiO1xuICAgIGNhc2UgXCJJTUFHRV9TQUZFVFlcIjpcbiAgICBjYXNlIFwiUkVDSVRBVElPTlwiOlxuICAgIGNhc2UgXCJTQUZFVFlcIjpcbiAgICBjYXNlIFwiQkxPQ0tMSVNUXCI6XG4gICAgY2FzZSBcIlBST0hJQklURURfQ09OVEVOVFwiOlxuICAgIGNhc2UgXCJTUElJXCI6XG4gICAgICByZXR1cm4gXCJjb250ZW50LWZpbHRlclwiO1xuICAgIGNhc2UgXCJGSU5JU0hfUkVBU09OX1VOU1BFQ0lGSUVEXCI6XG4gICAgY2FzZSBcIk9USEVSXCI6XG4gICAgICByZXR1cm4gXCJvdGhlclwiO1xuICAgIGNhc2UgXCJNQUxGT1JNRURfRlVOQ1RJT05fQ0FMTFwiOlxuICAgICAgcmV0dXJuIFwiZXJyb3JcIjtcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIFwidW5rbm93blwiO1xuICB9XG59XG5cbi8vIHNyYy9nb29nbGUtZ2VuZXJhdGl2ZS1haS1sYW5ndWFnZS1tb2RlbC50c1xudmFyIEdvb2dsZUdlbmVyYXRpdmVBSUxhbmd1YWdlTW9kZWwgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKG1vZGVsSWQsIHNldHRpbmdzLCBjb25maWcpIHtcbiAgICB0aGlzLnNwZWNpZmljYXRpb25WZXJzaW9uID0gXCJ2MVwiO1xuICAgIHRoaXMuZGVmYXVsdE9iamVjdEdlbmVyYXRpb25Nb2RlID0gXCJqc29uXCI7XG4gICAgdGhpcy5zdXBwb3J0c0ltYWdlVXJscyA9IGZhbHNlO1xuICAgIHRoaXMubW9kZWxJZCA9IG1vZGVsSWQ7XG4gICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuICB9XG4gIGdldCBzdXBwb3J0c1N0cnVjdHVyZWRPdXRwdXRzKCkge1xuICAgIHZhciBfYTtcbiAgICByZXR1cm4gKF9hID0gdGhpcy5zZXR0aW5ncy5zdHJ1Y3R1cmVkT3V0cHV0cykgIT0gbnVsbCA/IF9hIDogdHJ1ZTtcbiAgfVxuICBnZXQgcHJvdmlkZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnLnByb3ZpZGVyO1xuICB9XG4gIGFzeW5jIGdldEFyZ3Moe1xuICAgIG1vZGUsXG4gICAgcHJvbXB0LFxuICAgIG1heFRva2VucyxcbiAgICB0ZW1wZXJhdHVyZSxcbiAgICB0b3BQLFxuICAgIHRvcEssXG4gICAgZnJlcXVlbmN5UGVuYWx0eSxcbiAgICBwcmVzZW5jZVBlbmFsdHksXG4gICAgc3RvcFNlcXVlbmNlcyxcbiAgICByZXNwb25zZUZvcm1hdCxcbiAgICBzZWVkLFxuICAgIHByb3ZpZGVyTWV0YWRhdGFcbiAgfSkge1xuICAgIHZhciBfYSwgX2IsIF9jO1xuICAgIGNvbnN0IHR5cGUgPSBtb2RlLnR5cGU7XG4gICAgY29uc3Qgd2FybmluZ3MgPSBbXTtcbiAgICBjb25zdCBnb29nbGVPcHRpb25zID0gcGFyc2VQcm92aWRlck9wdGlvbnMoe1xuICAgICAgcHJvdmlkZXI6IFwiZ29vZ2xlXCIsXG4gICAgICBwcm92aWRlck9wdGlvbnM6IHByb3ZpZGVyTWV0YWRhdGEsXG4gICAgICBzY2hlbWE6IGdvb2dsZUdlbmVyYXRpdmVBSVByb3ZpZGVyT3B0aW9uc1NjaGVtYVxuICAgIH0pO1xuICAgIGlmICgoKF9hID0gZ29vZ2xlT3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogZ29vZ2xlT3B0aW9ucy50aGlua2luZ0NvbmZpZykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmluY2x1ZGVUaG91Z2h0cykgPT09IHRydWUgJiYgIXRoaXMuY29uZmlnLnByb3ZpZGVyLnN0YXJ0c1dpdGgoXCJnb29nbGUudmVydGV4LlwiKSkge1xuICAgICAgd2FybmluZ3MucHVzaCh7XG4gICAgICAgIHR5cGU6IFwib3RoZXJcIixcbiAgICAgICAgbWVzc2FnZTogYFRoZSAnaW5jbHVkZVRob3VnaHRzJyBvcHRpb24gaXMgb25seSBzdXBwb3J0ZWQgd2l0aCB0aGUgR29vZ2xlIFZlcnRleCBwcm92aWRlciBhbmQgbWlnaHQgbm90IGJlIHN1cHBvcnRlZCBvciBjb3VsZCBiZWhhdmUgdW5leHBlY3RlZGx5IHdpdGggdGhlIGN1cnJlbnQgR29vZ2xlIHByb3ZpZGVyICgke3RoaXMuY29uZmlnLnByb3ZpZGVyfSkuYFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGdlbmVyYXRpb25Db25maWcgPSB7XG4gICAgICAvLyBzdGFuZGFyZGl6ZWQgc2V0dGluZ3M6XG4gICAgICBtYXhPdXRwdXRUb2tlbnM6IG1heFRva2VucyxcbiAgICAgIHRlbXBlcmF0dXJlLFxuICAgICAgdG9wSyxcbiAgICAgIHRvcFAsXG4gICAgICBmcmVxdWVuY3lQZW5hbHR5LFxuICAgICAgcHJlc2VuY2VQZW5hbHR5LFxuICAgICAgc3RvcFNlcXVlbmNlcyxcbiAgICAgIHNlZWQsXG4gICAgICAvLyByZXNwb25zZSBmb3JtYXQ6XG4gICAgICByZXNwb25zZU1pbWVUeXBlOiAocmVzcG9uc2VGb3JtYXQgPT0gbnVsbCA/IHZvaWQgMCA6IHJlc3BvbnNlRm9ybWF0LnR5cGUpID09PSBcImpzb25cIiA/IFwiYXBwbGljYXRpb24vanNvblwiIDogdm9pZCAwLFxuICAgICAgcmVzcG9uc2VTY2hlbWE6IChyZXNwb25zZUZvcm1hdCA9PSBudWxsID8gdm9pZCAwIDogcmVzcG9uc2VGb3JtYXQudHlwZSkgPT09IFwianNvblwiICYmIHJlc3BvbnNlRm9ybWF0LnNjaGVtYSAhPSBudWxsICYmIC8vIEdvb2dsZSBHZW5BSSBkb2VzIG5vdCBzdXBwb3J0IGFsbCBPcGVuQVBJIFNjaGVtYSBmZWF0dXJlcyxcbiAgICAgIC8vIHNvIHRoaXMgaXMgbmVlZGVkIGFzIGFuIGVzY2FwZSBoYXRjaDpcbiAgICAgIHRoaXMuc3VwcG9ydHNTdHJ1Y3R1cmVkT3V0cHV0cyA/IGNvbnZlcnRKU09OU2NoZW1hVG9PcGVuQVBJU2NoZW1hKHJlc3BvbnNlRm9ybWF0LnNjaGVtYSkgOiB2b2lkIDAsXG4gICAgICAuLi50aGlzLnNldHRpbmdzLmF1ZGlvVGltZXN0YW1wICYmIHtcbiAgICAgICAgYXVkaW9UaW1lc3RhbXA6IHRoaXMuc2V0dGluZ3MuYXVkaW9UaW1lc3RhbXBcbiAgICAgIH0sXG4gICAgICAvLyBwcm92aWRlciBvcHRpb25zOlxuICAgICAgcmVzcG9uc2VNb2RhbGl0aWVzOiBnb29nbGVPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBnb29nbGVPcHRpb25zLnJlc3BvbnNlTW9kYWxpdGllcyxcbiAgICAgIHRoaW5raW5nQ29uZmlnOiBnb29nbGVPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBnb29nbGVPcHRpb25zLnRoaW5raW5nQ29uZmlnXG4gICAgfTtcbiAgICBjb25zdCB7IGNvbnRlbnRzLCBzeXN0ZW1JbnN0cnVjdGlvbiB9ID0gY29udmVydFRvR29vZ2xlR2VuZXJhdGl2ZUFJTWVzc2FnZXMocHJvbXB0KTtcbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgIGNhc2UgXCJyZWd1bGFyXCI6IHtcbiAgICAgICAgY29uc3QgeyB0b29scywgdG9vbENvbmZpZywgdG9vbFdhcm5pbmdzIH0gPSBwcmVwYXJlVG9vbHMoXG4gICAgICAgICAgbW9kZSxcbiAgICAgICAgICAoX2IgPSB0aGlzLnNldHRpbmdzLnVzZVNlYXJjaEdyb3VuZGluZykgIT0gbnVsbCA/IF9iIDogZmFsc2UsXG4gICAgICAgICAgdGhpcy5zZXR0aW5ncy5keW5hbWljUmV0cmlldmFsQ29uZmlnLFxuICAgICAgICAgIHRoaXMubW9kZWxJZFxuICAgICAgICApO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGFyZ3M6IHtcbiAgICAgICAgICAgIGdlbmVyYXRpb25Db25maWcsXG4gICAgICAgICAgICBjb250ZW50cyxcbiAgICAgICAgICAgIHN5c3RlbUluc3RydWN0aW9uLFxuICAgICAgICAgICAgc2FmZXR5U2V0dGluZ3M6IHRoaXMuc2V0dGluZ3Muc2FmZXR5U2V0dGluZ3MsXG4gICAgICAgICAgICB0b29scyxcbiAgICAgICAgICAgIHRvb2xDb25maWcsXG4gICAgICAgICAgICBjYWNoZWRDb250ZW50OiB0aGlzLnNldHRpbmdzLmNhY2hlZENvbnRlbnRcbiAgICAgICAgICB9LFxuICAgICAgICAgIHdhcm5pbmdzOiBbLi4ud2FybmluZ3MsIC4uLnRvb2xXYXJuaW5nc11cbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGNhc2UgXCJvYmplY3QtanNvblwiOiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgYXJnczoge1xuICAgICAgICAgICAgZ2VuZXJhdGlvbkNvbmZpZzoge1xuICAgICAgICAgICAgICAuLi5nZW5lcmF0aW9uQ29uZmlnLFxuICAgICAgICAgICAgICByZXNwb25zZU1pbWVUeXBlOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICAgICAgcmVzcG9uc2VTY2hlbWE6IG1vZGUuc2NoZW1hICE9IG51bGwgJiYgLy8gR29vZ2xlIEdlbkFJIGRvZXMgbm90IHN1cHBvcnQgYWxsIE9wZW5BUEkgU2NoZW1hIGZlYXR1cmVzLFxuICAgICAgICAgICAgICAvLyBzbyB0aGlzIGlzIG5lZWRlZCBhcyBhbiBlc2NhcGUgaGF0Y2g6XG4gICAgICAgICAgICAgIHRoaXMuc3VwcG9ydHNTdHJ1Y3R1cmVkT3V0cHV0cyA/IGNvbnZlcnRKU09OU2NoZW1hVG9PcGVuQVBJU2NoZW1hKG1vZGUuc2NoZW1hKSA6IHZvaWQgMFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvbnRlbnRzLFxuICAgICAgICAgICAgc3lzdGVtSW5zdHJ1Y3Rpb24sXG4gICAgICAgICAgICBzYWZldHlTZXR0aW5nczogdGhpcy5zZXR0aW5ncy5zYWZldHlTZXR0aW5ncyxcbiAgICAgICAgICAgIGNhY2hlZENvbnRlbnQ6IHRoaXMuc2V0dGluZ3MuY2FjaGVkQ29udGVudFxuICAgICAgICAgIH0sXG4gICAgICAgICAgd2FybmluZ3NcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGNhc2UgXCJvYmplY3QtdG9vbFwiOiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgYXJnczoge1xuICAgICAgICAgICAgZ2VuZXJhdGlvbkNvbmZpZyxcbiAgICAgICAgICAgIGNvbnRlbnRzLFxuICAgICAgICAgICAgc3lzdGVtSW5zdHJ1Y3Rpb24sXG4gICAgICAgICAgICB0b29sczoge1xuICAgICAgICAgICAgICBmdW5jdGlvbkRlY2xhcmF0aW9uczogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIG5hbWU6IG1vZGUudG9vbC5uYW1lLFxuICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IChfYyA9IG1vZGUudG9vbC5kZXNjcmlwdGlvbikgIT0gbnVsbCA/IF9jIDogXCJcIixcbiAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnM6IGNvbnZlcnRKU09OU2NoZW1hVG9PcGVuQVBJU2NoZW1hKFxuICAgICAgICAgICAgICAgICAgICBtb2RlLnRvb2wucGFyYW1ldGVyc1xuICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRvb2xDb25maWc6IHsgZnVuY3Rpb25DYWxsaW5nQ29uZmlnOiB7IG1vZGU6IFwiQU5ZXCIgfSB9LFxuICAgICAgICAgICAgc2FmZXR5U2V0dGluZ3M6IHRoaXMuc2V0dGluZ3Muc2FmZXR5U2V0dGluZ3MsXG4gICAgICAgICAgICBjYWNoZWRDb250ZW50OiB0aGlzLnNldHRpbmdzLmNhY2hlZENvbnRlbnRcbiAgICAgICAgICB9LFxuICAgICAgICAgIHdhcm5pbmdzXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBkZWZhdWx0OiB7XG4gICAgICAgIGNvbnN0IF9leGhhdXN0aXZlQ2hlY2sgPSB0eXBlO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIHR5cGU6ICR7X2V4aGF1c3RpdmVDaGVja31gKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgc3VwcG9ydHNVcmwodXJsKSB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnLmlzU3VwcG9ydGVkVXJsKHVybCk7XG4gIH1cbiAgYXN5bmMgZG9HZW5lcmF0ZShvcHRpb25zKSB7XG4gICAgdmFyIF9hLCBfYiwgX2MsIF9kLCBfZTtcbiAgICBjb25zdCB7IGFyZ3MsIHdhcm5pbmdzIH0gPSBhd2FpdCB0aGlzLmdldEFyZ3Mob3B0aW9ucyk7XG4gICAgY29uc3QgYm9keSA9IEpTT04uc3RyaW5naWZ5KGFyZ3MpO1xuICAgIGNvbnN0IG1lcmdlZEhlYWRlcnMgPSBjb21iaW5lSGVhZGVycyhcbiAgICAgIGF3YWl0IHJlc29sdmUodGhpcy5jb25maWcuaGVhZGVycyksXG4gICAgICBvcHRpb25zLmhlYWRlcnNcbiAgICApO1xuICAgIGNvbnN0IHtcbiAgICAgIHJlc3BvbnNlSGVhZGVycyxcbiAgICAgIHZhbHVlOiByZXNwb25zZSxcbiAgICAgIHJhd1ZhbHVlOiByYXdSZXNwb25zZVxuICAgIH0gPSBhd2FpdCBwb3N0SnNvblRvQXBpKHtcbiAgICAgIHVybDogYCR7dGhpcy5jb25maWcuYmFzZVVSTH0vJHtnZXRNb2RlbFBhdGgoXG4gICAgICAgIHRoaXMubW9kZWxJZFxuICAgICAgKX06Z2VuZXJhdGVDb250ZW50YCxcbiAgICAgIGhlYWRlcnM6IG1lcmdlZEhlYWRlcnMsXG4gICAgICBib2R5OiBhcmdzLFxuICAgICAgZmFpbGVkUmVzcG9uc2VIYW5kbGVyOiBnb29nbGVGYWlsZWRSZXNwb25zZUhhbmRsZXIsXG4gICAgICBzdWNjZXNzZnVsUmVzcG9uc2VIYW5kbGVyOiBjcmVhdGVKc29uUmVzcG9uc2VIYW5kbGVyKHJlc3BvbnNlU2NoZW1hKSxcbiAgICAgIGFib3J0U2lnbmFsOiBvcHRpb25zLmFib3J0U2lnbmFsLFxuICAgICAgZmV0Y2g6IHRoaXMuY29uZmlnLmZldGNoXG4gICAgfSk7XG4gICAgY29uc3QgeyBjb250ZW50czogcmF3UHJvbXB0LCAuLi5yYXdTZXR0aW5ncyB9ID0gYXJncztcbiAgICBjb25zdCBjYW5kaWRhdGUgPSByZXNwb25zZS5jYW5kaWRhdGVzWzBdO1xuICAgIGNvbnN0IHBhcnRzID0gY2FuZGlkYXRlLmNvbnRlbnQgPT0gbnVsbCB8fCB0eXBlb2YgY2FuZGlkYXRlLmNvbnRlbnQgIT09IFwib2JqZWN0XCIgfHwgIShcInBhcnRzXCIgaW4gY2FuZGlkYXRlLmNvbnRlbnQpID8gW10gOiBjYW5kaWRhdGUuY29udGVudC5wYXJ0cztcbiAgICBjb25zdCB0b29sQ2FsbHMgPSBnZXRUb29sQ2FsbHNGcm9tUGFydHMoe1xuICAgICAgcGFydHMsXG4gICAgICAvLyBVc2UgY2FuZGlkYXRlUGFydHNcbiAgICAgIGdlbmVyYXRlSWQ6IHRoaXMuY29uZmlnLmdlbmVyYXRlSWRcbiAgICB9KTtcbiAgICBjb25zdCB1c2FnZU1ldGFkYXRhID0gcmVzcG9uc2UudXNhZ2VNZXRhZGF0YTtcbiAgICByZXR1cm4ge1xuICAgICAgdGV4dDogZ2V0VGV4dEZyb21QYXJ0cyhwYXJ0cyksXG4gICAgICByZWFzb25pbmc6IGdldFJlYXNvbmluZ0RldGFpbHNGcm9tUGFydHMocGFydHMpLFxuICAgICAgZmlsZXM6IChfYSA9IGdldElubGluZURhdGFQYXJ0cyhwYXJ0cykpID09IG51bGwgPyB2b2lkIDAgOiBfYS5tYXAoKHBhcnQpID0+ICh7XG4gICAgICAgIGRhdGE6IHBhcnQuaW5saW5lRGF0YS5kYXRhLFxuICAgICAgICBtaW1lVHlwZTogcGFydC5pbmxpbmVEYXRhLm1pbWVUeXBlXG4gICAgICB9KSksXG4gICAgICB0b29sQ2FsbHMsXG4gICAgICBmaW5pc2hSZWFzb246IG1hcEdvb2dsZUdlbmVyYXRpdmVBSUZpbmlzaFJlYXNvbih7XG4gICAgICAgIGZpbmlzaFJlYXNvbjogY2FuZGlkYXRlLmZpbmlzaFJlYXNvbixcbiAgICAgICAgaGFzVG9vbENhbGxzOiB0b29sQ2FsbHMgIT0gbnVsbCAmJiB0b29sQ2FsbHMubGVuZ3RoID4gMFxuICAgICAgfSksXG4gICAgICB1c2FnZToge1xuICAgICAgICBwcm9tcHRUb2tlbnM6IChfYiA9IHVzYWdlTWV0YWRhdGEgPT0gbnVsbCA/IHZvaWQgMCA6IHVzYWdlTWV0YWRhdGEucHJvbXB0VG9rZW5Db3VudCkgIT0gbnVsbCA/IF9iIDogTmFOLFxuICAgICAgICBjb21wbGV0aW9uVG9rZW5zOiAoX2MgPSB1c2FnZU1ldGFkYXRhID09IG51bGwgPyB2b2lkIDAgOiB1c2FnZU1ldGFkYXRhLmNhbmRpZGF0ZXNUb2tlbkNvdW50KSAhPSBudWxsID8gX2MgOiBOYU5cbiAgICAgIH0sXG4gICAgICByYXdDYWxsOiB7IHJhd1Byb21wdCwgcmF3U2V0dGluZ3MgfSxcbiAgICAgIHJhd1Jlc3BvbnNlOiB7IGhlYWRlcnM6IHJlc3BvbnNlSGVhZGVycywgYm9keTogcmF3UmVzcG9uc2UgfSxcbiAgICAgIHdhcm5pbmdzLFxuICAgICAgcHJvdmlkZXJNZXRhZGF0YToge1xuICAgICAgICBnb29nbGU6IHtcbiAgICAgICAgICBncm91bmRpbmdNZXRhZGF0YTogKF9kID0gY2FuZGlkYXRlLmdyb3VuZGluZ01ldGFkYXRhKSAhPSBudWxsID8gX2QgOiBudWxsLFxuICAgICAgICAgIHNhZmV0eVJhdGluZ3M6IChfZSA9IGNhbmRpZGF0ZS5zYWZldHlSYXRpbmdzKSAhPSBudWxsID8gX2UgOiBudWxsXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBzb3VyY2VzOiBleHRyYWN0U291cmNlcyh7XG4gICAgICAgIGdyb3VuZGluZ01ldGFkYXRhOiBjYW5kaWRhdGUuZ3JvdW5kaW5nTWV0YWRhdGEsXG4gICAgICAgIGdlbmVyYXRlSWQ6IHRoaXMuY29uZmlnLmdlbmVyYXRlSWRcbiAgICAgIH0pLFxuICAgICAgcmVxdWVzdDogeyBib2R5IH1cbiAgICB9O1xuICB9XG4gIGFzeW5jIGRvU3RyZWFtKG9wdGlvbnMpIHtcbiAgICBjb25zdCB7IGFyZ3MsIHdhcm5pbmdzIH0gPSBhd2FpdCB0aGlzLmdldEFyZ3Mob3B0aW9ucyk7XG4gICAgY29uc3QgYm9keSA9IEpTT04uc3RyaW5naWZ5KGFyZ3MpO1xuICAgIGNvbnN0IGhlYWRlcnMgPSBjb21iaW5lSGVhZGVycyhcbiAgICAgIGF3YWl0IHJlc29sdmUodGhpcy5jb25maWcuaGVhZGVycyksXG4gICAgICBvcHRpb25zLmhlYWRlcnNcbiAgICApO1xuICAgIGNvbnN0IHsgcmVzcG9uc2VIZWFkZXJzLCB2YWx1ZTogcmVzcG9uc2UgfSA9IGF3YWl0IHBvc3RKc29uVG9BcGkoe1xuICAgICAgdXJsOiBgJHt0aGlzLmNvbmZpZy5iYXNlVVJMfS8ke2dldE1vZGVsUGF0aChcbiAgICAgICAgdGhpcy5tb2RlbElkXG4gICAgICApfTpzdHJlYW1HZW5lcmF0ZUNvbnRlbnQ/YWx0PXNzZWAsXG4gICAgICBoZWFkZXJzLFxuICAgICAgYm9keTogYXJncyxcbiAgICAgIGZhaWxlZFJlc3BvbnNlSGFuZGxlcjogZ29vZ2xlRmFpbGVkUmVzcG9uc2VIYW5kbGVyLFxuICAgICAgc3VjY2Vzc2Z1bFJlc3BvbnNlSGFuZGxlcjogY3JlYXRlRXZlbnRTb3VyY2VSZXNwb25zZUhhbmRsZXIoY2h1bmtTY2hlbWEpLFxuICAgICAgYWJvcnRTaWduYWw6IG9wdGlvbnMuYWJvcnRTaWduYWwsXG4gICAgICBmZXRjaDogdGhpcy5jb25maWcuZmV0Y2hcbiAgICB9KTtcbiAgICBjb25zdCB7IGNvbnRlbnRzOiByYXdQcm9tcHQsIC4uLnJhd1NldHRpbmdzIH0gPSBhcmdzO1xuICAgIGxldCBmaW5pc2hSZWFzb24gPSBcInVua25vd25cIjtcbiAgICBsZXQgdXNhZ2UgPSB7XG4gICAgICBwcm9tcHRUb2tlbnM6IE51bWJlci5OYU4sXG4gICAgICBjb21wbGV0aW9uVG9rZW5zOiBOdW1iZXIuTmFOXG4gICAgfTtcbiAgICBsZXQgcHJvdmlkZXJNZXRhZGF0YSA9IHZvaWQgMDtcbiAgICBjb25zdCBnZW5lcmF0ZUlkMiA9IHRoaXMuY29uZmlnLmdlbmVyYXRlSWQ7XG4gICAgbGV0IGhhc1Rvb2xDYWxscyA9IGZhbHNlO1xuICAgIHJldHVybiB7XG4gICAgICBzdHJlYW06IHJlc3BvbnNlLnBpcGVUaHJvdWdoKFxuICAgICAgICBuZXcgVHJhbnNmb3JtU3RyZWFtKHtcbiAgICAgICAgICB0cmFuc2Zvcm0oY2h1bmssIGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIHZhciBfYSwgX2IsIF9jLCBfZCwgX2UsIF9mO1xuICAgICAgICAgICAgaWYgKCFjaHVuay5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7IHR5cGU6IFwiZXJyb3JcIiwgZXJyb3I6IGNodW5rLmVycm9yIH0pO1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGNodW5rLnZhbHVlO1xuICAgICAgICAgICAgY29uc3QgdXNhZ2VNZXRhZGF0YSA9IHZhbHVlLnVzYWdlTWV0YWRhdGE7XG4gICAgICAgICAgICBpZiAodXNhZ2VNZXRhZGF0YSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgIHVzYWdlID0ge1xuICAgICAgICAgICAgICAgIHByb21wdFRva2VuczogKF9hID0gdXNhZ2VNZXRhZGF0YS5wcm9tcHRUb2tlbkNvdW50KSAhPSBudWxsID8gX2EgOiBOYU4sXG4gICAgICAgICAgICAgICAgY29tcGxldGlvblRva2VuczogKF9iID0gdXNhZ2VNZXRhZGF0YS5jYW5kaWRhdGVzVG9rZW5Db3VudCkgIT0gbnVsbCA/IF9iIDogTmFOXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBjYW5kaWRhdGUgPSAoX2MgPSB2YWx1ZS5jYW5kaWRhdGVzKSA9PSBudWxsID8gdm9pZCAwIDogX2NbMF07XG4gICAgICAgICAgICBpZiAoY2FuZGlkYXRlID09IG51bGwpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGNhbmRpZGF0ZS5jb250ZW50O1xuICAgICAgICAgICAgaWYgKGNvbnRlbnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICBjb25zdCBkZWx0YVRleHQgPSBnZXRUZXh0RnJvbVBhcnRzKGNvbnRlbnQucGFydHMpO1xuICAgICAgICAgICAgICBpZiAoZGVsdGFUZXh0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJ0ZXh0LWRlbHRhXCIsXG4gICAgICAgICAgICAgICAgICB0ZXh0RGVsdGE6IGRlbHRhVGV4dFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNvbnN0IHJlYXNvbmluZ0RlbHRhVGV4dCA9IGdldFJlYXNvbmluZ0RldGFpbHNGcm9tUGFydHMoXG4gICAgICAgICAgICAgICAgY29udGVudC5wYXJ0c1xuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICBpZiAocmVhc29uaW5nRGVsdGFUZXh0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHBhcnQgb2YgcmVhc29uaW5nRGVsdGFUZXh0KSB7XG4gICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInJlYXNvbmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0RGVsdGE6IHBhcnQudGV4dFxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNvbnN0IGlubGluZURhdGFQYXJ0cyA9IGdldElubGluZURhdGFQYXJ0cyhjb250ZW50LnBhcnRzKTtcbiAgICAgICAgICAgICAgaWYgKGlubGluZURhdGFQYXJ0cyAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBwYXJ0IG9mIGlubGluZURhdGFQYXJ0cykge1xuICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJmaWxlXCIsXG4gICAgICAgICAgICAgICAgICAgIG1pbWVUeXBlOiBwYXJ0LmlubGluZURhdGEubWltZVR5cGUsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHBhcnQuaW5saW5lRGF0YS5kYXRhXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgY29uc3QgdG9vbENhbGxEZWx0YXMgPSBnZXRUb29sQ2FsbHNGcm9tUGFydHMoe1xuICAgICAgICAgICAgICAgIHBhcnRzOiBjb250ZW50LnBhcnRzLFxuICAgICAgICAgICAgICAgIGdlbmVyYXRlSWQ6IGdlbmVyYXRlSWQyXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBpZiAodG9vbENhbGxEZWx0YXMgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdG9vbENhbGwgb2YgdG9vbENhbGxEZWx0YXMpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwidG9vbC1jYWxsLWRlbHRhXCIsXG4gICAgICAgICAgICAgICAgICAgIHRvb2xDYWxsVHlwZTogXCJmdW5jdGlvblwiLFxuICAgICAgICAgICAgICAgICAgICB0b29sQ2FsbElkOiB0b29sQ2FsbC50b29sQ2FsbElkLFxuICAgICAgICAgICAgICAgICAgICB0b29sTmFtZTogdG9vbENhbGwudG9vbE5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGFyZ3NUZXh0RGVsdGE6IHRvb2xDYWxsLmFyZ3NcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJ0b29sLWNhbGxcIixcbiAgICAgICAgICAgICAgICAgICAgdG9vbENhbGxUeXBlOiBcImZ1bmN0aW9uXCIsXG4gICAgICAgICAgICAgICAgICAgIHRvb2xDYWxsSWQ6IHRvb2xDYWxsLnRvb2xDYWxsSWQsXG4gICAgICAgICAgICAgICAgICAgIHRvb2xOYW1lOiB0b29sQ2FsbC50b29sTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgYXJnczogdG9vbENhbGwuYXJnc1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICBoYXNUb29sQ2FsbHMgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNhbmRpZGF0ZS5maW5pc2hSZWFzb24gIT0gbnVsbCkge1xuICAgICAgICAgICAgICBmaW5pc2hSZWFzb24gPSBtYXBHb29nbGVHZW5lcmF0aXZlQUlGaW5pc2hSZWFzb24oe1xuICAgICAgICAgICAgICAgIGZpbmlzaFJlYXNvbjogY2FuZGlkYXRlLmZpbmlzaFJlYXNvbixcbiAgICAgICAgICAgICAgICBoYXNUb29sQ2FsbHNcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGNvbnN0IHNvdXJjZXMgPSAoX2QgPSBleHRyYWN0U291cmNlcyh7XG4gICAgICAgICAgICAgICAgZ3JvdW5kaW5nTWV0YWRhdGE6IGNhbmRpZGF0ZS5ncm91bmRpbmdNZXRhZGF0YSxcbiAgICAgICAgICAgICAgICBnZW5lcmF0ZUlkOiBnZW5lcmF0ZUlkMlxuICAgICAgICAgICAgICB9KSkgIT0gbnVsbCA/IF9kIDogW107XG4gICAgICAgICAgICAgIGZvciAoY29uc3Qgc291cmNlIG9mIHNvdXJjZXMpIHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoeyB0eXBlOiBcInNvdXJjZVwiLCBzb3VyY2UgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcHJvdmlkZXJNZXRhZGF0YSA9IHtcbiAgICAgICAgICAgICAgICBnb29nbGU6IHtcbiAgICAgICAgICAgICAgICAgIGdyb3VuZGluZ01ldGFkYXRhOiAoX2UgPSBjYW5kaWRhdGUuZ3JvdW5kaW5nTWV0YWRhdGEpICE9IG51bGwgPyBfZSA6IG51bGwsXG4gICAgICAgICAgICAgICAgICBzYWZldHlSYXRpbmdzOiAoX2YgPSBjYW5kaWRhdGUuc2FmZXR5UmF0aW5ncykgIT0gbnVsbCA/IF9mIDogbnVsbFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIGZsdXNoKGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7XG4gICAgICAgICAgICAgIHR5cGU6IFwiZmluaXNoXCIsXG4gICAgICAgICAgICAgIGZpbmlzaFJlYXNvbixcbiAgICAgICAgICAgICAgdXNhZ2UsXG4gICAgICAgICAgICAgIHByb3ZpZGVyTWV0YWRhdGFcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICksXG4gICAgICByYXdDYWxsOiB7IHJhd1Byb21wdCwgcmF3U2V0dGluZ3MgfSxcbiAgICAgIHJhd1Jlc3BvbnNlOiB7IGhlYWRlcnM6IHJlc3BvbnNlSGVhZGVycyB9LFxuICAgICAgd2FybmluZ3MsXG4gICAgICByZXF1ZXN0OiB7IGJvZHkgfVxuICAgIH07XG4gIH1cbn07XG5mdW5jdGlvbiBnZXRUb29sQ2FsbHNGcm9tUGFydHMoe1xuICBwYXJ0cyxcbiAgZ2VuZXJhdGVJZDogZ2VuZXJhdGVJZDJcbn0pIHtcbiAgY29uc3QgZnVuY3Rpb25DYWxsUGFydHMgPSBwYXJ0cyA9PSBudWxsID8gdm9pZCAwIDogcGFydHMuZmlsdGVyKFxuICAgIChwYXJ0KSA9PiBcImZ1bmN0aW9uQ2FsbFwiIGluIHBhcnRcbiAgKTtcbiAgcmV0dXJuIGZ1bmN0aW9uQ2FsbFBhcnRzID09IG51bGwgfHwgZnVuY3Rpb25DYWxsUGFydHMubGVuZ3RoID09PSAwID8gdm9pZCAwIDogZnVuY3Rpb25DYWxsUGFydHMubWFwKChwYXJ0KSA9PiAoe1xuICAgIHRvb2xDYWxsVHlwZTogXCJmdW5jdGlvblwiLFxuICAgIHRvb2xDYWxsSWQ6IGdlbmVyYXRlSWQyKCksXG4gICAgdG9vbE5hbWU6IHBhcnQuZnVuY3Rpb25DYWxsLm5hbWUsXG4gICAgYXJnczogSlNPTi5zdHJpbmdpZnkocGFydC5mdW5jdGlvbkNhbGwuYXJncylcbiAgfSkpO1xufVxuZnVuY3Rpb24gZ2V0VGV4dEZyb21QYXJ0cyhwYXJ0cykge1xuICBjb25zdCB0ZXh0UGFydHMgPSBwYXJ0cyA9PSBudWxsID8gdm9pZCAwIDogcGFydHMuZmlsdGVyKFxuICAgIChwYXJ0KSA9PiBcInRleHRcIiBpbiBwYXJ0ICYmIHBhcnQudGhvdWdodCAhPT0gdHJ1ZVxuICApO1xuICByZXR1cm4gdGV4dFBhcnRzID09IG51bGwgfHwgdGV4dFBhcnRzLmxlbmd0aCA9PT0gMCA/IHZvaWQgMCA6IHRleHRQYXJ0cy5tYXAoKHBhcnQpID0+IHBhcnQudGV4dCkuam9pbihcIlwiKTtcbn1cbmZ1bmN0aW9uIGdldFJlYXNvbmluZ0RldGFpbHNGcm9tUGFydHMocGFydHMpIHtcbiAgY29uc3QgcmVhc29uaW5nUGFydHMgPSBwYXJ0cyA9PSBudWxsID8gdm9pZCAwIDogcGFydHMuZmlsdGVyKFxuICAgIChwYXJ0KSA9PiBcInRleHRcIiBpbiBwYXJ0ICYmIHBhcnQudGhvdWdodCA9PT0gdHJ1ZSAmJiBwYXJ0LnRleHQgIT0gbnVsbFxuICApO1xuICByZXR1cm4gcmVhc29uaW5nUGFydHMgPT0gbnVsbCB8fCByZWFzb25pbmdQYXJ0cy5sZW5ndGggPT09IDAgPyB2b2lkIDAgOiByZWFzb25pbmdQYXJ0cy5tYXAoKHBhcnQpID0+ICh7IHR5cGU6IFwidGV4dFwiLCB0ZXh0OiBwYXJ0LnRleHQgfSkpO1xufVxuZnVuY3Rpb24gZ2V0SW5saW5lRGF0YVBhcnRzKHBhcnRzKSB7XG4gIHJldHVybiBwYXJ0cyA9PSBudWxsID8gdm9pZCAwIDogcGFydHMuZmlsdGVyKFxuICAgIChwYXJ0KSA9PiBcImlubGluZURhdGFcIiBpbiBwYXJ0XG4gICk7XG59XG5mdW5jdGlvbiBleHRyYWN0U291cmNlcyh7XG4gIGdyb3VuZGluZ01ldGFkYXRhLFxuICBnZW5lcmF0ZUlkOiBnZW5lcmF0ZUlkMlxufSkge1xuICB2YXIgX2E7XG4gIHJldHVybiAoX2EgPSBncm91bmRpbmdNZXRhZGF0YSA9PSBudWxsID8gdm9pZCAwIDogZ3JvdW5kaW5nTWV0YWRhdGEuZ3JvdW5kaW5nQ2h1bmtzKSA9PSBudWxsID8gdm9pZCAwIDogX2EuZmlsdGVyKFxuICAgIChjaHVuaykgPT4gY2h1bmsud2ViICE9IG51bGxcbiAgKS5tYXAoKGNodW5rKSA9PiAoe1xuICAgIHNvdXJjZVR5cGU6IFwidXJsXCIsXG4gICAgaWQ6IGdlbmVyYXRlSWQyKCksXG4gICAgdXJsOiBjaHVuay53ZWIudXJpLFxuICAgIHRpdGxlOiBjaHVuay53ZWIudGl0bGVcbiAgfSkpO1xufVxudmFyIGNvbnRlbnRTY2hlbWEgPSB6Mi5vYmplY3Qoe1xuICBwYXJ0czogejIuYXJyYXkoXG4gICAgejIudW5pb24oW1xuICAgICAgLy8gbm90ZTogb3JkZXIgbWF0dGVycyBzaW5jZSB0ZXh0IGNhbiBiZSBmdWxseSBlbXB0eVxuICAgICAgejIub2JqZWN0KHtcbiAgICAgICAgZnVuY3Rpb25DYWxsOiB6Mi5vYmplY3Qoe1xuICAgICAgICAgIG5hbWU6IHoyLnN0cmluZygpLFxuICAgICAgICAgIGFyZ3M6IHoyLnVua25vd24oKVxuICAgICAgICB9KVxuICAgICAgfSksXG4gICAgICB6Mi5vYmplY3Qoe1xuICAgICAgICBpbmxpbmVEYXRhOiB6Mi5vYmplY3Qoe1xuICAgICAgICAgIG1pbWVUeXBlOiB6Mi5zdHJpbmcoKSxcbiAgICAgICAgICBkYXRhOiB6Mi5zdHJpbmcoKVxuICAgICAgICB9KVxuICAgICAgfSksXG4gICAgICB6Mi5vYmplY3Qoe1xuICAgICAgICB0ZXh0OiB6Mi5zdHJpbmcoKS5udWxsaXNoKCksXG4gICAgICAgIHRob3VnaHQ6IHoyLmJvb2xlYW4oKS5udWxsaXNoKClcbiAgICAgIH0pXG4gICAgXSlcbiAgKS5udWxsaXNoKClcbn0pO1xudmFyIGdyb3VuZGluZ0NodW5rU2NoZW1hID0gejIub2JqZWN0KHtcbiAgd2ViOiB6Mi5vYmplY3QoeyB1cmk6IHoyLnN0cmluZygpLCB0aXRsZTogejIuc3RyaW5nKCkgfSkubnVsbGlzaCgpLFxuICByZXRyaWV2ZWRDb250ZXh0OiB6Mi5vYmplY3QoeyB1cmk6IHoyLnN0cmluZygpLCB0aXRsZTogejIuc3RyaW5nKCkgfSkubnVsbGlzaCgpXG59KTtcbnZhciBncm91bmRpbmdNZXRhZGF0YVNjaGVtYSA9IHoyLm9iamVjdCh7XG4gIHdlYlNlYXJjaFF1ZXJpZXM6IHoyLmFycmF5KHoyLnN0cmluZygpKS5udWxsaXNoKCksXG4gIHJldHJpZXZhbFF1ZXJpZXM6IHoyLmFycmF5KHoyLnN0cmluZygpKS5udWxsaXNoKCksXG4gIHNlYXJjaEVudHJ5UG9pbnQ6IHoyLm9iamVjdCh7IHJlbmRlcmVkQ29udGVudDogejIuc3RyaW5nKCkgfSkubnVsbGlzaCgpLFxuICBncm91bmRpbmdDaHVua3M6IHoyLmFycmF5KGdyb3VuZGluZ0NodW5rU2NoZW1hKS5udWxsaXNoKCksXG4gIGdyb3VuZGluZ1N1cHBvcnRzOiB6Mi5hcnJheShcbiAgICB6Mi5vYmplY3Qoe1xuICAgICAgc2VnbWVudDogejIub2JqZWN0KHtcbiAgICAgICAgc3RhcnRJbmRleDogejIubnVtYmVyKCkubnVsbGlzaCgpLFxuICAgICAgICBlbmRJbmRleDogejIubnVtYmVyKCkubnVsbGlzaCgpLFxuICAgICAgICB0ZXh0OiB6Mi5zdHJpbmcoKS5udWxsaXNoKClcbiAgICAgIH0pLFxuICAgICAgc2VnbWVudF90ZXh0OiB6Mi5zdHJpbmcoKS5udWxsaXNoKCksXG4gICAgICBncm91bmRpbmdDaHVua0luZGljZXM6IHoyLmFycmF5KHoyLm51bWJlcigpKS5udWxsaXNoKCksXG4gICAgICBzdXBwb3J0Q2h1bmtJbmRpY2VzOiB6Mi5hcnJheSh6Mi5udW1iZXIoKSkubnVsbGlzaCgpLFxuICAgICAgY29uZmlkZW5jZVNjb3JlczogejIuYXJyYXkoejIubnVtYmVyKCkpLm51bGxpc2goKSxcbiAgICAgIGNvbmZpZGVuY2VTY29yZTogejIuYXJyYXkoejIubnVtYmVyKCkpLm51bGxpc2goKVxuICAgIH0pXG4gICkubnVsbGlzaCgpLFxuICByZXRyaWV2YWxNZXRhZGF0YTogejIudW5pb24oW1xuICAgIHoyLm9iamVjdCh7XG4gICAgICB3ZWJEeW5hbWljUmV0cmlldmFsU2NvcmU6IHoyLm51bWJlcigpXG4gICAgfSksXG4gICAgejIub2JqZWN0KHt9KVxuICBdKS5udWxsaXNoKClcbn0pO1xudmFyIHNhZmV0eVJhdGluZ1NjaGVtYSA9IHoyLm9iamVjdCh7XG4gIGNhdGVnb3J5OiB6Mi5zdHJpbmcoKS5udWxsaXNoKCksXG4gIHByb2JhYmlsaXR5OiB6Mi5zdHJpbmcoKS5udWxsaXNoKCksXG4gIHByb2JhYmlsaXR5U2NvcmU6IHoyLm51bWJlcigpLm51bGxpc2goKSxcbiAgc2V2ZXJpdHk6IHoyLnN0cmluZygpLm51bGxpc2goKSxcbiAgc2V2ZXJpdHlTY29yZTogejIubnVtYmVyKCkubnVsbGlzaCgpLFxuICBibG9ja2VkOiB6Mi5ib29sZWFuKCkubnVsbGlzaCgpXG59KTtcbnZhciByZXNwb25zZVNjaGVtYSA9IHoyLm9iamVjdCh7XG4gIGNhbmRpZGF0ZXM6IHoyLmFycmF5KFxuICAgIHoyLm9iamVjdCh7XG4gICAgICBjb250ZW50OiBjb250ZW50U2NoZW1hLm51bGxpc2goKS5vcih6Mi5vYmplY3Qoe30pLnN0cmljdCgpKSxcbiAgICAgIGZpbmlzaFJlYXNvbjogejIuc3RyaW5nKCkubnVsbGlzaCgpLFxuICAgICAgc2FmZXR5UmF0aW5nczogejIuYXJyYXkoc2FmZXR5UmF0aW5nU2NoZW1hKS5udWxsaXNoKCksXG4gICAgICBncm91bmRpbmdNZXRhZGF0YTogZ3JvdW5kaW5nTWV0YWRhdGFTY2hlbWEubnVsbGlzaCgpXG4gICAgfSlcbiAgKSxcbiAgdXNhZ2VNZXRhZGF0YTogejIub2JqZWN0KHtcbiAgICBwcm9tcHRUb2tlbkNvdW50OiB6Mi5udW1iZXIoKS5udWxsaXNoKCksXG4gICAgY2FuZGlkYXRlc1Rva2VuQ291bnQ6IHoyLm51bWJlcigpLm51bGxpc2goKSxcbiAgICB0b3RhbFRva2VuQ291bnQ6IHoyLm51bWJlcigpLm51bGxpc2goKVxuICB9KS5udWxsaXNoKClcbn0pO1xudmFyIGNodW5rU2NoZW1hID0gejIub2JqZWN0KHtcbiAgY2FuZGlkYXRlczogejIuYXJyYXkoXG4gICAgejIub2JqZWN0KHtcbiAgICAgIGNvbnRlbnQ6IGNvbnRlbnRTY2hlbWEubnVsbGlzaCgpLFxuICAgICAgZmluaXNoUmVhc29uOiB6Mi5zdHJpbmcoKS5udWxsaXNoKCksXG4gICAgICBzYWZldHlSYXRpbmdzOiB6Mi5hcnJheShzYWZldHlSYXRpbmdTY2hlbWEpLm51bGxpc2goKSxcbiAgICAgIGdyb3VuZGluZ01ldGFkYXRhOiBncm91bmRpbmdNZXRhZGF0YVNjaGVtYS5udWxsaXNoKClcbiAgICB9KVxuICApLm51bGxpc2goKSxcbiAgdXNhZ2VNZXRhZGF0YTogejIub2JqZWN0KHtcbiAgICBwcm9tcHRUb2tlbkNvdW50OiB6Mi5udW1iZXIoKS5udWxsaXNoKCksXG4gICAgY2FuZGlkYXRlc1Rva2VuQ291bnQ6IHoyLm51bWJlcigpLm51bGxpc2goKSxcbiAgICB0b3RhbFRva2VuQ291bnQ6IHoyLm51bWJlcigpLm51bGxpc2goKVxuICB9KS5udWxsaXNoKClcbn0pO1xudmFyIGdvb2dsZUdlbmVyYXRpdmVBSVByb3ZpZGVyT3B0aW9uc1NjaGVtYSA9IHoyLm9iamVjdCh7XG4gIHJlc3BvbnNlTW9kYWxpdGllczogejIuYXJyYXkoejIuZW51bShbXCJURVhUXCIsIFwiSU1BR0VcIl0pKS5udWxsaXNoKCksXG4gIHRoaW5raW5nQ29uZmlnOiB6Mi5vYmplY3Qoe1xuICAgIHRoaW5raW5nQnVkZ2V0OiB6Mi5udW1iZXIoKS5udWxsaXNoKCksXG4gICAgaW5jbHVkZVRob3VnaHRzOiB6Mi5ib29sZWFuKCkubnVsbGlzaCgpXG4gIH0pLm51bGxpc2goKVxufSk7XG5cbi8vIHNyYy9nb29nbGUtZ2VuZXJhdGl2ZS1haS1lbWJlZGRpbmctbW9kZWwudHNcbmltcG9ydCB7XG4gIFRvb01hbnlFbWJlZGRpbmdWYWx1ZXNGb3JDYWxsRXJyb3Jcbn0gZnJvbSBcIkBhaS1zZGsvcHJvdmlkZXJcIjtcbmltcG9ydCB7XG4gIGNvbWJpbmVIZWFkZXJzIGFzIGNvbWJpbmVIZWFkZXJzMixcbiAgY3JlYXRlSnNvblJlc3BvbnNlSGFuZGxlciBhcyBjcmVhdGVKc29uUmVzcG9uc2VIYW5kbGVyMixcbiAgcG9zdEpzb25Ub0FwaSBhcyBwb3N0SnNvblRvQXBpMixcbiAgcmVzb2x2ZSBhcyByZXNvbHZlMlxufSBmcm9tIFwiQGFpLXNkay9wcm92aWRlci11dGlsc1wiO1xuaW1wb3J0IHsgeiBhcyB6MyB9IGZyb20gXCJ6b2RcIjtcbnZhciBHb29nbGVHZW5lcmF0aXZlQUlFbWJlZGRpbmdNb2RlbCA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IobW9kZWxJZCwgc2V0dGluZ3MsIGNvbmZpZykge1xuICAgIHRoaXMuc3BlY2lmaWNhdGlvblZlcnNpb24gPSBcInYxXCI7XG4gICAgdGhpcy5tb2RlbElkID0gbW9kZWxJZDtcbiAgICB0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7XG4gICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gIH1cbiAgZ2V0IHByb3ZpZGVyKCkge1xuICAgIHJldHVybiB0aGlzLmNvbmZpZy5wcm92aWRlcjtcbiAgfVxuICBnZXQgbWF4RW1iZWRkaW5nc1BlckNhbGwoKSB7XG4gICAgcmV0dXJuIDIwNDg7XG4gIH1cbiAgZ2V0IHN1cHBvcnRzUGFyYWxsZWxDYWxscygpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBhc3luYyBkb0VtYmVkKHtcbiAgICB2YWx1ZXMsXG4gICAgaGVhZGVycyxcbiAgICBhYm9ydFNpZ25hbFxuICB9KSB7XG4gICAgaWYgKHZhbHVlcy5sZW5ndGggPiB0aGlzLm1heEVtYmVkZGluZ3NQZXJDYWxsKSB7XG4gICAgICB0aHJvdyBuZXcgVG9vTWFueUVtYmVkZGluZ1ZhbHVlc0ZvckNhbGxFcnJvcih7XG4gICAgICAgIHByb3ZpZGVyOiB0aGlzLnByb3ZpZGVyLFxuICAgICAgICBtb2RlbElkOiB0aGlzLm1vZGVsSWQsXG4gICAgICAgIG1heEVtYmVkZGluZ3NQZXJDYWxsOiB0aGlzLm1heEVtYmVkZGluZ3NQZXJDYWxsLFxuICAgICAgICB2YWx1ZXNcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBtZXJnZWRIZWFkZXJzID0gY29tYmluZUhlYWRlcnMyKFxuICAgICAgYXdhaXQgcmVzb2x2ZTIodGhpcy5jb25maWcuaGVhZGVycyksXG4gICAgICBoZWFkZXJzXG4gICAgKTtcbiAgICBjb25zdCB7IHJlc3BvbnNlSGVhZGVycywgdmFsdWU6IHJlc3BvbnNlIH0gPSBhd2FpdCBwb3N0SnNvblRvQXBpMih7XG4gICAgICB1cmw6IGAke3RoaXMuY29uZmlnLmJhc2VVUkx9L21vZGVscy8ke3RoaXMubW9kZWxJZH06YmF0Y2hFbWJlZENvbnRlbnRzYCxcbiAgICAgIGhlYWRlcnM6IG1lcmdlZEhlYWRlcnMsXG4gICAgICBib2R5OiB7XG4gICAgICAgIHJlcXVlc3RzOiB2YWx1ZXMubWFwKCh2YWx1ZSkgPT4gKHtcbiAgICAgICAgICBtb2RlbDogYG1vZGVscy8ke3RoaXMubW9kZWxJZH1gLFxuICAgICAgICAgIGNvbnRlbnQ6IHsgcm9sZTogXCJ1c2VyXCIsIHBhcnRzOiBbeyB0ZXh0OiB2YWx1ZSB9XSB9LFxuICAgICAgICAgIG91dHB1dERpbWVuc2lvbmFsaXR5OiB0aGlzLnNldHRpbmdzLm91dHB1dERpbWVuc2lvbmFsaXR5LFxuICAgICAgICAgIHRhc2tUeXBlOiB0aGlzLnNldHRpbmdzLnRhc2tUeXBlXG4gICAgICAgIH0pKVxuICAgICAgfSxcbiAgICAgIGZhaWxlZFJlc3BvbnNlSGFuZGxlcjogZ29vZ2xlRmFpbGVkUmVzcG9uc2VIYW5kbGVyLFxuICAgICAgc3VjY2Vzc2Z1bFJlc3BvbnNlSGFuZGxlcjogY3JlYXRlSnNvblJlc3BvbnNlSGFuZGxlcjIoXG4gICAgICAgIGdvb2dsZUdlbmVyYXRpdmVBSVRleHRFbWJlZGRpbmdSZXNwb25zZVNjaGVtYVxuICAgICAgKSxcbiAgICAgIGFib3J0U2lnbmFsLFxuICAgICAgZmV0Y2g6IHRoaXMuY29uZmlnLmZldGNoXG4gICAgfSk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGVtYmVkZGluZ3M6IHJlc3BvbnNlLmVtYmVkZGluZ3MubWFwKChpdGVtKSA9PiBpdGVtLnZhbHVlcyksXG4gICAgICB1c2FnZTogdm9pZCAwLFxuICAgICAgcmF3UmVzcG9uc2U6IHsgaGVhZGVyczogcmVzcG9uc2VIZWFkZXJzIH1cbiAgICB9O1xuICB9XG59O1xudmFyIGdvb2dsZUdlbmVyYXRpdmVBSVRleHRFbWJlZGRpbmdSZXNwb25zZVNjaGVtYSA9IHozLm9iamVjdCh7XG4gIGVtYmVkZGluZ3M6IHozLmFycmF5KHozLm9iamVjdCh7IHZhbHVlczogejMuYXJyYXkoejMubnVtYmVyKCkpIH0pKVxufSk7XG5cbi8vIHNyYy9nb29nbGUtc3VwcG9ydGVkLWZpbGUtdXJsLnRzXG5mdW5jdGlvbiBpc1N1cHBvcnRlZEZpbGVVcmwodXJsKSB7XG4gIHJldHVybiB1cmwudG9TdHJpbmcoKS5zdGFydHNXaXRoKFwiaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL2ZpbGVzL1wiKTtcbn1cblxuLy8gc3JjL2dvb2dsZS1wcm92aWRlci50c1xuZnVuY3Rpb24gY3JlYXRlR29vZ2xlR2VuZXJhdGl2ZUFJKG9wdGlvbnMgPSB7fSkge1xuICB2YXIgX2E7XG4gIGNvbnN0IGJhc2VVUkwgPSAoX2EgPSB3aXRob3V0VHJhaWxpbmdTbGFzaChvcHRpb25zLmJhc2VVUkwpKSAhPSBudWxsID8gX2EgOiBcImh0dHBzOi8vZ2VuZXJhdGl2ZWxhbmd1YWdlLmdvb2dsZWFwaXMuY29tL3YxYmV0YVwiO1xuICBjb25zdCBnZXRIZWFkZXJzID0gKCkgPT4gKHtcbiAgICBcIngtZ29vZy1hcGkta2V5XCI6IGxvYWRBcGlLZXkoe1xuICAgICAgYXBpS2V5OiBvcHRpb25zLmFwaUtleSxcbiAgICAgIGVudmlyb25tZW50VmFyaWFibGVOYW1lOiBcIkdPT0dMRV9HRU5FUkFUSVZFX0FJX0FQSV9LRVlcIixcbiAgICAgIGRlc2NyaXB0aW9uOiBcIkdvb2dsZSBHZW5lcmF0aXZlIEFJXCJcbiAgICB9KSxcbiAgICAuLi5vcHRpb25zLmhlYWRlcnNcbiAgfSk7XG4gIGNvbnN0IGNyZWF0ZUNoYXRNb2RlbCA9IChtb2RlbElkLCBzZXR0aW5ncyA9IHt9KSA9PiB7XG4gICAgdmFyIF9hMjtcbiAgICByZXR1cm4gbmV3IEdvb2dsZUdlbmVyYXRpdmVBSUxhbmd1YWdlTW9kZWwobW9kZWxJZCwgc2V0dGluZ3MsIHtcbiAgICAgIHByb3ZpZGVyOiBcImdvb2dsZS5nZW5lcmF0aXZlLWFpXCIsXG4gICAgICBiYXNlVVJMLFxuICAgICAgaGVhZGVyczogZ2V0SGVhZGVycyxcbiAgICAgIGdlbmVyYXRlSWQ6IChfYTIgPSBvcHRpb25zLmdlbmVyYXRlSWQpICE9IG51bGwgPyBfYTIgOiBnZW5lcmF0ZUlkLFxuICAgICAgaXNTdXBwb3J0ZWRVcmw6IGlzU3VwcG9ydGVkRmlsZVVybCxcbiAgICAgIGZldGNoOiBvcHRpb25zLmZldGNoXG4gICAgfSk7XG4gIH07XG4gIGNvbnN0IGNyZWF0ZUVtYmVkZGluZ01vZGVsID0gKG1vZGVsSWQsIHNldHRpbmdzID0ge30pID0+IG5ldyBHb29nbGVHZW5lcmF0aXZlQUlFbWJlZGRpbmdNb2RlbChtb2RlbElkLCBzZXR0aW5ncywge1xuICAgIHByb3ZpZGVyOiBcImdvb2dsZS5nZW5lcmF0aXZlLWFpXCIsXG4gICAgYmFzZVVSTCxcbiAgICBoZWFkZXJzOiBnZXRIZWFkZXJzLFxuICAgIGZldGNoOiBvcHRpb25zLmZldGNoXG4gIH0pO1xuICBjb25zdCBwcm92aWRlciA9IGZ1bmN0aW9uKG1vZGVsSWQsIHNldHRpbmdzKSB7XG4gICAgaWYgKG5ldy50YXJnZXQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgXCJUaGUgR29vZ2xlIEdlbmVyYXRpdmUgQUkgbW9kZWwgZnVuY3Rpb24gY2Fubm90IGJlIGNhbGxlZCB3aXRoIHRoZSBuZXcga2V5d29yZC5cIlxuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIGNyZWF0ZUNoYXRNb2RlbChtb2RlbElkLCBzZXR0aW5ncyk7XG4gIH07XG4gIHByb3ZpZGVyLmxhbmd1YWdlTW9kZWwgPSBjcmVhdGVDaGF0TW9kZWw7XG4gIHByb3ZpZGVyLmNoYXQgPSBjcmVhdGVDaGF0TW9kZWw7XG4gIHByb3ZpZGVyLmdlbmVyYXRpdmVBSSA9IGNyZWF0ZUNoYXRNb2RlbDtcbiAgcHJvdmlkZXIuZW1iZWRkaW5nID0gY3JlYXRlRW1iZWRkaW5nTW9kZWw7XG4gIHByb3ZpZGVyLnRleHRFbWJlZGRpbmcgPSBjcmVhdGVFbWJlZGRpbmdNb2RlbDtcbiAgcHJvdmlkZXIudGV4dEVtYmVkZGluZ01vZGVsID0gY3JlYXRlRW1iZWRkaW5nTW9kZWw7XG4gIHJldHVybiBwcm92aWRlcjtcbn1cbnZhciBnb29nbGUgPSBjcmVhdGVHb29nbGVHZW5lcmF0aXZlQUkoKTtcbmV4cG9ydCB7XG4gIGNyZWF0ZUdvb2dsZUdlbmVyYXRpdmVBSSxcbiAgZ29vZ2xlXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXgubWpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/@ai-sdk+google@1.2.22_zod@3.24.2/node_modules/@ai-sdk/google/dist/index.mjs\n");

/***/ })

};
;